var CPWbot_bg,g_v2engine=!0,g_v3engine=!1;CPWbot_bg||(CPWbot_bg=new CPWbot_bg_lib);
var g_cpw_server_initiated_tabid=null,g_cpw_do_fakeui=!1,TYPE_ID="id",TYPE_NAME="name",TYPE_XPATH="xpath",FN_LOGIN=1,FN_PASSWORD=2,FN_LOGIN_OTHER=5,FN_CURRENT_PASS=10,FN_NEW_PASS=11,FN_NEW_PASS_CONFIRM=12,FN_CPW_OTHER=13,FN_CPW_INVALID=14,FN_LOGIN_INVALID=15,FN_LOGIN_SUCCESS=16,FN_LOGIN_SUCCESS_INVALID=17,FN_NAVIGATE_TO_CPW=18,FN_CPW_SUCCESS=19,FN_CPW_SUCCESS_INVALID=20,FN_NAVIGATE_TO_ACCTMGMT=21,FN_CPW_SUBMIT=22,FN_IS_LOGGED_IN=23,FN_IS_LOGGED_IN_NEGATION=24,FN_LOGIN_SUBMIT=25,FN_POPUP_EXISTS=26,
FN_POPUP_DISMISS=27,FN_REVEAL_LOGIN=28,FN_CHALLENGE_LOGIN=29,FN_CHALLENGE_PASSWORD=30,FN_CHALLENGE_OTHER=31,FN_CHALLENGE_SUBMIT=32,FN_CHALLENGE_INVALID=33,FN_CHALLENGE_SUCCESS=34,FN_CHALLENGE_SUCCESS_INVALID=35,FN_EPHEMERAL_STATE=37,FN_NAVIGATE_TO_LOGOUT=38,FN_CAPTCHA=39,FN_MULTI_FACTOR=40,FN_PASSWORD_HINT=41,FN_POPUP_EXISTS_INVALID=42,FN_FAKEUI_LOGGED_OUT_1=43,FN_FAKEUI_LOGGED_OUT_2=44,FN_FAKEUI_LOGGED_OUT_3=45,FN_FAKEUI_LOGGED_OUT_INPUT=46,FN_FAKEUI_LOGGED_IN_1=47,FN_FAKEUI_LOGGED_IN_2=48,FN_FAKEUI_LOGGED_IN_3=
49,FN_FAKEUI_LOGGED_IN_INPUT=50,FN_FORCE_FAIL=51,FN_CAPTCHA_SUCCESS=52,FN_MULTI_FACTOR_SUCCESS=53,FN_PASSWORD_HINT_SUCCESS=54,FN_LOGIN_ENTRY_INVALID=55,FN_LOGIN_ENTRY_USERNAME=56,FN_LOGIN_ENTRY_SUBMIT=57,FN_LOGIN_ENTRY_PASSWORD=58,FN_LOGIN_ENTRY_SUCCESS_INVALID=59,FN_LOGIN_ENTRY_SUCCESS=60,FN_REVEAL_LOGOUT=61,CONST_CLICK_NOMINAL=0,CONST_CLICK_NO_FOCUS=1,CONST_CLICK_MOUSEDOWN=2,CONST_CLICK_STRANGE=3,JS_PRE_NAVIGATE_CPW=1,JS_PRE_LOGIN=2,JS_POST_NAVIGATE_CPW=3,JS_POST_LOGIN=4,JS_PRE_CPW=5,JS_POST_CPW=
6,JS_PRE_ACCTMGMT=7,JS_POST_ACCTMGMT=8,JS_LOGIN_REVEAL=9,JS_VALIDATE_LOGIN_SUCCESS=10,JS_VALIDATE_CPW_SUCCESS=11,JS_LOGIN_SUBMIT=12,JS_FINISH=13,JS_PRE_CHALLENGE=14,JS_POST_CHALLENGE=15,JS_CHALLENGE_SUBMIT=16,JS_VALIDATE_CHALLENGE_SUCCESS=17,JS_BEGIN=18,JS_PRE_LOGOUT=19,JS_POST_LOGOUT=20,JS_LOGIN_ENTRY_SUBMIT=21,JS_PRE_LOGIN_ENTRY=22,JS_POST_LOGIN_ENTRY=23,JS_VALIDATE_LOGIN_ENTRY_SUCCESS=24,JS_PRE_DOCAPTCHA=25,JS_POST_DOCAPTCHA=26;
function replace_constants(g){if(!g)return null;if("undefined"!=typeof g.field_info)for(var e=0;e<g.field_info.length;e++){if("undefined"!=typeof g.field_info[e].id_type)switch(g.field_info[e].id_type){case "TYPE_ID":g.field_info[e].id_type=TYPE_ID;break;case "TYPE_NAME":g.field_info[e].id_type=TYPE_NAME;break;case "TYPE_XPATH":g.field_info[e].id_type=TYPE_XPATH}if("undefined"!=typeof g.field_info[e].id_function)switch(g.field_info[e].id_function){case "FN_LOGIN":g.field_info[e].id_function=FN_LOGIN;
break;case "FN_PASSWORD":g.field_info[e].id_function=FN_PASSWORD;break;case "FN_LOGIN_OTHER":g.field_info[e].id_function=FN_LOGIN_OTHER;break;case "FN_CURRENT_PASS":g.field_info[e].id_function=FN_CURRENT_PASS;break;case "FN_NEW_PASS":g.field_info[e].id_function=FN_NEW_PASS;break;case "FN_NEW_PASS_CONFIRM":g.field_info[e].id_function=FN_NEW_PASS_CONFIRM;break;case "FN_CPW_OTHER":g.field_info[e].id_function=FN_CPW_OTHER;break;case "FN_CPW_INVALID":g.field_info[e].id_function=FN_CPW_INVALID;break;case "FN_LOGIN_INVALID":g.field_info[e].id_function=
FN_LOGIN_INVALID;break;case "FN_LOGIN_SUCCESS":g.field_info[e].id_function=FN_LOGIN_SUCCESS;break;case "FN_LOGIN_SUCCESS_INVALID":g.field_info[e].id_function=FN_LOGIN_SUCCESS_INVALID;break;case "FN_NAVIGATE_TO_CPW":g.field_info[e].id_function=FN_NAVIGATE_TO_CPW;break;case "FN_CPW_SUCCESS":g.field_info[e].id_function=FN_CPW_SUCCESS;break;case "FN_CPW_SUCCESS_INVALID":g.field_info[e].id_function=FN_CPW_SUCCESS_INVALID;break;case "FN_NAVIGATE_TO_ACCTMGMT":g.field_info[e].id_function=FN_NAVIGATE_TO_ACCTMGMT;
break;case "FN_CPW_SUBMIT":g.field_info[e].id_function=FN_CPW_SUBMIT;break;case "FN_IS_LOGGED_IN":g.field_info[e].id_function=FN_IS_LOGGED_IN;break;case "FN_IS_LOGGED_IN_NEGATION":g.field_info[e].id_function=FN_IS_LOGGED_IN_NEGATION;break;case "FN_LOGIN_SUBMIT":g.field_info[e].id_function=FN_LOGIN_SUBMIT;break;case "FN_POPUP_EXISTS":g.field_info[e].id_function=FN_POPUP_EXISTS;break;case "FN_POPUP_DISMISS":g.field_info[e].id_function=FN_POPUP_DISMISS;break;case "FN_REVEAL_LOGIN":g.field_info[e].id_function=
FN_REVEAL_LOGIN;break;case "FN_CHALLENGE_LOGIN":g.field_info[e].id_function=FN_CHALLENGE_LOGIN;break;case "FN_CHALLENGE_PASSWORD":g.field_info[e].id_function=FN_CHALLENGE_PASSWORD;break;case "FN_CHALLENGE_OTHER":g.field_info[e].id_function=FN_CHALLENGE_OTHER;break;case "FN_CHALLENGE_SUBMIT":g.field_info[e].id_function=FN_CHALLENGE_SUBMIT;break;case "FN_CHALLENGE_INVALID":g.field_info[e].id_function=FN_CHALLENGE_INVALID;break;case "FN_CHALLENGE_SUCCESS":g.field_info[e].id_function=FN_CHALLENGE_SUCCESS;
break;case "FN_CHALLENGE_SUCCESS_INVALID":g.field_info[e].id_function=FN_CHALLENGE_SUCCESS_INVALID;break;case "FN_NAVIGATE_TO_LOGOUT":g.field_info[e].id_function=FN_NAVIGATE_TO_LOGOUT;break;case "FN_EPHEMERAL_STATE":g.field_info[e].id_function=FN_EPHEMERAL_STATE;break;case "FN_CAPTCHA":g.field_info[e].id_function=FN_CAPTCHA;break;case "FN_MULTI_FACTOR":g.field_info[e].id_function=FN_MULTI_FACTOR;break;case "FN_PASSWORD_HINT":g.field_info[e].id_function=FN_PASSWORD_HINT;break;case "FN_POPUP_EXISTS_INVALID":g.field_info[e].id_function=
FN_POPUP_EXISTS_INVALID;break;case "FN_FORCE_FAIL":g.field_info[e].id_function=FN_FORCE_FAIL;break;case "FN_CAPTCHA_SUCCESS":g.field_info[e].id_function=FN_CAPTCHA_SUCCESS;break;case "FN_MULTI_FACTOR_SUCCESS":g.field_info[e].id_function=FN_MULTI_FACTOR_SUCCESS;break;case "FN_PASSWORD_HINT_SUCCESS":g.field_info[e].id_function=FN_PASSWORD_HINT_SUCCESS;break;case "FN_LOGIN_ENTRY_INVALID":g.field_info[e].id_function=FN_LOGIN_ENTRY_INVALID;break;case "FN_LOGIN_ENTRY_USERNAME":g.field_info[e].id_function=
FN_LOGIN_ENTRY_USERNAME;break;case "FN_LOGIN_ENTRY_PASSWORD":g.field_info[e].id_function=FN_LOGIN_ENTRY_PASSWORD;break;case "FN_LOGIN_ENTRY_SUBMIT":g.field_info[e].id_function=FN_LOGIN_ENTRY_SUBMIT;break;case "FN_LOGIN_ENTRY_SUCCESS":g.field_info[e].id_function=FN_LOGIN_ENTRY_SUCCESS;break;case "FN_LOGIN_ENTRY_SUCCESS_INVALID":g.field_info[e].id_function=FN_LOGIN_ENTRY_SUCCESS_INVALID;break;case "FN_REVEAL_LOGOUT":g.field_info[e].id_function=FN_REVEAL_LOGOUT;break;case "FN_FAKEUI_LOGGED_IN_1":g.field_info[e].id_function=
FN_FAKEUI_LOGGED_IN_1;break;case "FN_FAKEUI_LOGGED_IN_2":g.field_info[e].id_function=FN_FAKEUI_LOGGED_IN_2;break;case "FN_FAKEUI_LOGGED_IN_3":g.field_info[e].id_function=FN_FAKEUI_LOGGED_IN_3;break;case "FN_FAKEUI_LOGGED_IN_INPUT":g.field_info[e].id_function=FN_FAKEUI_LOGGED_IN_INPUT;break;case "FN_FAKEUI_LOGGED_OUT_1":g.field_info[e].id_function=FN_FAKEUI_LOGGED_OUT_1;break;case "FN_FAKEUI_LOGGED_OUT_2":g.field_info[e].id_function=FN_FAKEUI_LOGGED_OUT_2;break;case "FN_FAKEUI_LOGGED_OUT_3":g.field_info[e].id_function=
FN_FAKEUI_LOGGED_OUT_3;break;case "FN_FAKEUI_LOGGED_OUT_OUTPUT":g.field_info[e].id_function=FN_FAKEUI_LOGGED_OUT_INPUT}}if("undefined"!=typeof g.jsfrags)for(e=0;e<g.jsfrags.length;e++)if("undefined"!=typeof g.jsfrags[e].jstype)switch(g.jsfrags[e].jstype){case "JS_PRE_NAVIGATE_CPW":g.jsfrags[e].jstype=JS_PRE_NAVIGATE_CPW;break;case "JS_PRE_LOGIN":g.jsfrags[e].jstype=JS_PRE_LOGIN;break;case "JS_POST_NAVIGATE_CPW":g.jsfrags[e].jstype=JS_POST_NAVIGATE_CPW;break;case "JS_POST_LOGIN":g.jsfrags[e].jstype=
JS_POST_LOGIN;break;case "JS_PRE_CPW":g.jsfrags[e].jstype=JS_PRE_CPW;break;case "JS_POST_CPW":g.jsfrags[e].jstype=JS_POST_CPW;break;case "JS_PRE_ACCTMGMT":g.jsfrags[e].jstype=JS_PRE_ACCTMGMT;break;case "JS_POST_ACCTMGMT":g.jsfrags[e].jstype=JS_POST_ACCTMGMT;break;case "JS_LOGIN_REVEAL":g.jsfrags[e].jstype=JS_LOGIN_REVEAL;break;case "JS_VALIDATE_LOGIN_SUCCESS":g.jsfrags[e].jstype=JS_VALIDATE_LOGIN_SUCCESS;break;case "JS_VALIDATE_CPW_SUCCESS":g.jsfrags[e].jstype=JS_VALIDATE_CPW_SUCCESS;break;case "JS_LOGIN_SUBMIT":g.jsfrags[e].jstype=
JS_LOGIN_SUBMIT;break;case "JS_FINISH":g.jsfrags[e].jstype=JS_FINISH;break;case "JS_PRE_CHALLENGE":g.jsfrags[e].jstype=JS_PRE_CHALLENGE;break;case "JS_POST_CHALLENGE":g.jsfrags[e].jstype=JS_POST_CHALLENGE;break;case "JS_CHALLENGE_SUBMIT":g.jsfrags[e].jstype=JS_CHALLENGE_SUBMIT;break;case "JS_VALIDATE_CHALLENGE_SUCCESS":g.jsfrags[e].jstype=JS_VALIDATE_CHALLENGE_SUCCESS;break;case "JS_BEGIN":g.jsfrags[e].jstype=JS_BEGIN;break;case "JS_PRE_LOGOUT":g.jsfrags[e].jstype=JS_PRE_LOGOUT;break;case "JS_POST_LOGOUT":g.jsfrags[e].jstype=
JS_POST_LOGOUT;break;case "JS_PRE_LOGIN_ENTRY":g.jsfrags[e].jstype=JS_PRE_LOGIN_ENTRY;break;case "JS_POST_LOGIN_ENTRY":g.jsfrags[e].jstype=JS_POST_LOGIN_ENTRY;break;case "JS_LOGIN_ENTRY_SUBMIT":g.jsfrags[e].jstype=JS_LOGIN_ENTRY_SUBMIT;break;case "JS_PRE_DOCAPTCHA":g.jsfrags[e].jstype=JS_PRE_DOCAPTCHA;break;case "JS_POST_DOCAPTCHA":g.jsfrags[e].jstype=JS_POST_DOCAPTCHA}if("undefined"!=typeof g.click_flavor)switch(g.click_flavor){case "CLICK_NO_FOCUS":g.click_flavor=CONST_CLICK_NO_FOCUS;break;case "CLICK_MOUSEDOWN":g.click_flavor=
CONST_CLICK_MOUSEDOWN;break;case "CLICK_STRANGE":g.click_flavor=CONST_CLICK_STRANGE;break;default:g.click_flavor=CONST_CLICK_NOMINAL}return g}
var DEFAULT_CLICK_DELAY=250,DEFAULT_FILL_DELAY=250,DEFAULT_SESSION_TIMEOUT=12E4,DEFAULT_VALIDATE_TIMEOUT=1E4,CLICK_RETRY_TIME=5E3,recipe_template={version:1,symbolic:"",login_url:"",acctmgmt_url:null,cpw_url:"",logout_url:"",login_entry_url:"",fakeui_loggedout_url:"",fakeui_loggedin_url:"",validate_timeout:5E3,field_info:[],jsfrags:[],cpw_delay:250,login_delay:250,acctmgmt_delay:250,login_reveal_delay:250,logout_reveal_delay:250,logout_delay:250,fill_field_delay:250,click_field_delay:250,trigger_cpw_delay:0,
cpw_change_success_url:null,cpw_change_failure_url:null,login_failure_url:null,login_success_url:null,login_entry_failure_url:null,login_entry_success_url:null,challenge_invalidate_url:null,challenge_validate_url:null,click_flavor:CONST_CLICK_NOMINAL,generate_pref_overrides:null,reveal_login_js_delay:0,reveal_cpw_js_delay:0,navigate_acctmgmt_js_delay:0,postreveallogin_sleep:0,postacctmgmt_sleep:0,postrevealcpw_sleep:0,posttrigger_sleep:0,postlogout_sleep:0,start_delay:0,post_login_submit_delay:1100,
post_js_begin_delay:5555,js_finish_delay:2E3,session_timeout:DEFAULT_SESSION_TIMEOUT,document_complete_timeout:0,proceed_on_interactive:0,click_on_fields_on_fill:0,fill_password_fields_via_keys:0},r_tesco={},r_netflix={},minimal_recipe={symbolic:"",login_url:"",field_info:[],generate_pref_overrides:{minlength:6}},telegraph={symbolic:"Daily Telegraph"},amex={symbolic:"American Express",field_info:[],jsfrag:[]},boa={symbolic:"Bank of America",login_url:"https://www.bankofamerica.com/sitemap/hub/signin.go",
field_info:[{id_type:"TYPE_ID",id_value:"userId",id_function:"FN_LOGIN"},{id_type:"TYPE_ID",id_value:"password",id_function:"FN_PASSWORD"}],jsfrag:[]},capitalone={generate_pref_overrides:{mindigits:2,digits:1,special:0}},capitalone360={},testrig={symbolic:"Test",login_url:"http://www.netrot.net/~chang/form/formtest1.html",field_info:[{id_type:"TYPE_ID",id_value:"email",id_function:"FN_LOGIN"},{id_type:"TYPE_NAME",id_value:"password",id_function:"FN_PASSWORD"},{id_type:"TYPE_XPATH",id_value:"//input[@type='submit']",
id_function:"FN_LOGIN_SUBMIT"},{id_type:"TYPE_ID",id_value:"email",id_function:"FN_IS_LOGGED_IN_NEGATION"},{id_type:"TYPE_XPATH",id_value:"//input[@type='submit']",id_function:"FN_CPW_SUBMIT"}],jsfrag:[],generate_pref_overrides:{mindigits:1,digits:1,special:0,minlength:6}};
function CPWbot_bg_lib(){function g(a){m_last_overlay_msg=a}function e(){m_last_overlay_msg=""}function I(a){return!a?null:a.logout_url}function H(a){if(!a)return null;var b=a.click_flavor;return"string"==typeof b&&(b=parseInt(b),!isNaN(b))?b:a.click_flavor}function q(a){return J(a,FN_PASSWORD)}function Oa(a){return J(a,FN_LOGIN)}function Pa(a){return J(a,FN_LOGIN_SUBMIT)}function lb(a){return J(a,FN_REVEAL_LOGIN)}function J(a,b){if(!a||!a.field_info)return null;var c,d=null,f=null;for(c=0;c<a.field_info.length;c++)if(d=
a.field_info[c],d.id_function==b){f={id_type:d.id_type,id_value:d.id_value};break}return f}function Lb(a){return v(a,JS_PRE_NAVIGATE_CPW)}function mb(a){return v(a,JS_POST_NAVIGATE_CPW)}function Mb(a){return v(a,JS_PRE_ACCTMGMT)}function nb(a){return v(a,JS_POST_ACCTMGMT)}function Nb(a){return v(a,JS_PRE_CPW)}function Ob(a){return v(a,JS_POST_CPW)}function Jc(a){return v(a,JS_PRE_LOGIN)}function Kc(a){return v(a,JS_POST_LOGIN)}function ob(a){return v(a,JS_LOGIN_REVEAL)}function Lc(a){return v(a,JS_LOGIN_SUBMIT)}
function Mc(a){return v(a,JS_LOGIN_ENTRY_SUBMIT)}function Pb(a){return v(a,JS_VALIDATE_LOGIN_SUCCESS)}function Qb(a){return v(a,JS_VALIDATE_CPW_SUCCESS)}function Rb(a){return v(a,JS_FINISH)}function Nc(a){return v(a,JS_VALIDATE_CHALLENGE_SUCCESS)}function Sb(a){return v(a,JS_BEGIN)}function Oc(a){return v(a,JS_PRE_LOGOUT)}function Tb(a){return v(a,JS_POST_LOGOUT)}function Pc(a){return v(a,JS_PRE_LOGIN_ENTRY)}function Qc(a){return v(a,JS_POST_LOGIN_ENTRY)}function Rc(a){return v(a,JS_VALIDATE_LOGIN_ENTRY_SUCCESS)}
function Sc(a){return v(a,JS_PRE_DOCAPTCHA)}function Tc(a){return v(a,JS_POST_DOCAPTCHA)}function Ub(a){var b=null;a&&"undefined"!=typeof a.cpw_change_success_url&&(b=a.cpw_change_success_url);return b}function Vb(a){var b=null;a&&"undefined"!=typeof a.cpw_change_failure_url&&(b=a.cpw_change_failure_url);return b}function Wb(a){var b=null;a&&"undefined"!=typeof a.login_failure_url&&(b=a.login_failure_url);return b}function Xb(a){var b=null;a&&"undefined"!=typeof a.login_success_url&&(b=a.login_success_url);
return b}function Uc(a){var b=null;a&&"undefined"!=typeof a.login_entry_failure_url&&(b=a.login_entry_failure_url);return b}function Vc(a){var b=null;a&&"undefined"!=typeof a.login_entry_success_url&&(b=a.login_entry_success_url);return b}function Wc(a){var b=null;a&&"undefined"!=typeof a.challenge_invalidate_url&&(b=a.challenge_invalidate_url);return b}function Xc(a){var b=null;a&&"undefined"!=typeof a.challenge_validate_url&&(b=a.challenge_validate_url);return b}function v(a,b){if(!a||!a.jsfrags)return null;
var c,d,f;for(c=0;c<a.jsfrags.length;c++)if(d=a.jsfrags[c],d.jstype==b){f=d.jsfrag;break}return f}function A(a,b,c){if(!b||!c)return null;if(b=c(b)){c=(new Date).getTime();null===c&&(c=0);var d=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+b+c.toString());c=("function"==typeof fasthash?fasthash:"function"==typeof crc32?crc32:"function(j) { if (j) { return j.length; } return 0; }")(b);verbose_log("injecting javascript fragment into CS: "+b);n(K,"Injected Javascript into Document");sendCS(a,
{cmd:"run_cpwbot_js",req_id:d,js:b,hash:c},"all");return!0}return!1}function va(a){return"undefined"!=typeof g_sites?g_sites[a]:"undefined"!=typeof lpaccts?lpaccts[a]:null}function Yb(a,b,c,d,f,m){if(!c)return!1;null===d&&(d=0);null===m&&(m=0);if("undefined"==typeof f||null===f)f=DEFAULT_FILL_DELAY;n(K,"Filling Field");var g=(new Date).getTime();null===g&&(g=0);g=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+c.id_value+g.toString());sendCS(a,{cmd:"cpwbot_fill_field",req_id:g,id_type:c.id_type,
id_value:c.id_value,field_value:b,type:"text",formname:"",should_click:d,should_fill_via_keys:m,delay:f},"all");return!0}function la(a,b,c,d,f,m,g){if(!c)return!1;null===d&&(d=0);null===m&&(m=0);if("undefined"==typeof f||null===f)f=DEFAULT_FILL_DELAY;n(K,"Filling Password Field");var e=(new Date).getTime();null===e&&(e=0);e=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+c.id_value+e.toString());sendCS(a,{cmd:"cpwbot_fill_field",req_id:e,id_type:c.id_type,id_value:c.id_value,field_value:b,
type:"password",formname:"",should_click:d,should_fill_via_keys:m,delay:f,flavor:g},"all");return!0}function ma(a,b,c,d){if(!b)return!1;if("undefined"==typeof c||null===c)c=DEFAULT_CLICK_DELAY;"undefined"==typeof d&&(d=CONST_CLICK_NOMINAL);Zb=(new Date).getTime()+CLICK_RETRY_TIME+c;pb=!1;n(K,"Clicking");var f=(new Date).getTime();null===f&&(f=0);f=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+b.id_value+f.toString());verbose_log("click_field id="+f+" saved to m_pwchange_last_click_field_id");
na=f;Qa=0;b={cmd:"cpwbot_click_field",msgid:f,pwchangestate:h,id_type:b.id_type,id_value:b.id_value,delay:c,flavor:d};sendCS(a,b,"all");m_lastclick_metadata=b;return!0}function Ra(a,b,c){if(!b||!c)return!1;var d="",d="",f=va(c.aid);if(!f)return Ba("given invalid aid - data consistency error?"),!1;CPWbot_bg.do_milestone(a,$b,b);L("pre-login-form-js");A(a,b,Jc);var m=Oa(b);c=q(b);var g=Sa(b),e=Ta(b),h=rnd2=0;qb&&(h=W(),rnd2=W());var M=0,j=H(b);m&&(M++,d=getusernamefromacct(f),Yb(a,d,m,g,0*M+h,!1,j));
c&&(M++,d=getpasswordfromacct(f),la(a,d,c,g,0*M+h+rnd2,e,j));L("post-login-form-js");A(a,b,Kc);return!0}function rb(a,b){if(!b)return!1;CPWbot_bg.do_milestone(a,ac,b);var c=!1;oa=!1;var d=Pa(b);if(d){c=DEFAULT_CLICK_DELAY;"undefined"!=typeof b.login_delay&&(c=b.login_delay);oa=!0;var f=H(b);ma(a,d,c,f);c=!0}A(a,b,Lc)&&(c=!0);return c?null:!0}function bc(a,b,c){if(!b||!c)return!1;var d="",d="",f=va(c.aid);if(!f)return Ba("given invalid aid - data consistency error?"),!1;CPWbot_bg.do_milestone(a,cc,
b);A(a,b,Pc);var m=J(b,FN_LOGIN_ENTRY_USERNAME);c=J(b,FN_LOGIN_ENTRY_PASSWORD);var g=Sa(b),e=Ta(b),h=rnd2=0;qb&&(h=W(),rnd2=W());var M=0,j=H(b);m&&(M++,d=getusernamefromacct(f),Yb(a,d,m,g,0*M+h,!1,j));c&&(M++,d=getpasswordfromacct(f),la(a,d,c,g,0*M+h+rnd2,e,j));A(a,b,Qc);return!0}function dc(a,b){if(!b)return!1;CPWbot_bg.do_milestone(a,ec,b);var c=!1;pa=!1;var d=J(b,FN_LOGIN_ENTRY_SUBMIT);if(d){c=DEFAULT_CLICK_DELAY;"undefined"!=typeof b.login_delay&&(c=b.login_delay);pa=!0;var f=H(b);ma(a,d,c,f);
CPWbot_bg.mark_timestamp("wait_for_click_ack_M");c=!0}A(a,b,Mc)&&(c=!0);return c?null:!0}function z(a){verbose_log("entered cpwbot_cs_finish to clean up "+a);if(null!==x)if(x!=a)null!==x&&verbose_log("stale call: started up a new password change on different tab - ABORT - tabid=="+a+" g_pwchangetabid="+x);else{var b={aid:qa,recipe:B,desc:"cpwbot_finish"};g_v2engine?CPWbot_bg.wait_for_doc_complete(a,null,function(a){verbose_log("cpwbot_finish callback!  on tabid="+a);sendCS(a,{cmd:"cpwbot_finish"},
"all")},b):sendCS(a,{cmd:"cpwbot_finish"})}}function Yc(a){var b=[],c=[FN_CPW_OTHER,FN_CURRENT_PASS,FN_NEW_PASS,FN_NEW_PASS_CONFIRM],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function Zc(a){var b=[],c=[FN_CPW_INVALID],d,f;for(d=0;d<c.length;d++){var m=D(a,c[d]);if(m&&0<m.length)for(f=0;f<m.length;f++){var g=m[f];g&&b.push(g)}}return b}function $c(a){var b=[],c=[FN_PASSWORD,FN_LOGIN_OTHER],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}
function ad(a){var b=[],c=[FN_LOGIN_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function bd(a){var b=[],c=[FN_LOGIN_ENTRY_USERNAME],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function cd(a){var b=[],c=[FN_LOGIN_ENTRY_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function dd(a){var b=[],c=[FN_LOGIN_SUCCESS],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}
function ed(a){var b=[],c=[FN_LOGIN_SUCCESS_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function fd(a){var b=[],c=[FN_LOGIN_ENTRY_SUCCESS],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function gd(a){var b=[],c=[FN_LOGIN_ENTRY_SUCCESS_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function hd(a){var b=[],c=[FN_CPW_SUCCESS],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&
(b=b.concat(f))}return b}function id(a){var b=[],c=[FN_CPW_SUCCESS_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function jd(a){var b=[],c=[FN_IS_LOGGED_IN],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function kd(a){var b=[],c=[FN_IS_LOGGED_IN_NEGATION],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function ld(a){var b=[],c=[FN_CHALLENGE_PASSWORD,FN_CHALLENGE_OTHER],d;for(d=0;d<c.length;d++){var f=
D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function md(a){var b=[],c=[FN_CHALLENGE_INVALID],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function nd(){return J(recipe_obj,FN_CHALLENGE_SUCCESS)}function od(){return J(recipe_obj,FN_CHALLENGE_SUCCESS_INVALID)}function fc(a){var b=[],c=[FN_CAPTCHA_SUCCESS,FN_PASSWORD_HINT_SUCCESS,FN_MULTI_FACTOR_SUCCESS],d;for(d=0;d<c.length;d++){var f=D(a,c[d]);f&&0<f.length&&(b=b.concat(f))}return b}function D(a,b){var c=
[];if(!a||!a.field_info)return c;var d,f;for(d=0;d<a.field_info.length;d++)f=a.field_info[d],f.id_function==b&&(f={id_type:f.id_type,id_value:f.id_value},c.push(f));return c}function Ua(a){var b=DEFAULT_VALIDATE_TIMEOUT;if(!a)return b;"undefined"!=typeof a.validate_timeout&&(a=parseInt(a.validate_timeout))&&!isNaN(a)&&(b=a);return b}function $(a,b,c){null===c&&(c=1);if(null===a||!b)return!1;var d=b.desc;c=b.recipe;var f=b.fn_url_failed,m=b.fn_url_success,g=b.fn_required,e=b.fn_rejected;t=!0;sb=(new Date).getTime();
aa=ca=!1;console_log("cpwbot check_tab_for_state for "+d);b=g?g(c):[];var g=e?e(c):[],h=CPWbot_bg.JSON.stringify(b),M=CPWbot_bg.JSON.stringify(g),e=[],j=[FN_CAPTCHA,FN_PASSWORD_HINT,FN_MULTI_FACTOR],n;for(n=0;n<j.length;n++){var q=D(c,j[n]);q&&0<q.length&&(e=e.concat(q))}e=CPWbot_bg.JSON.stringify(e);tb=gc(a);if(0==b.length&&0==g.length&&!m&&!f)return L("WARN: "+d+" has no field or url criteria defined to validate against"),!0;b=Ua(c);m=m?m(c):null;f=f?f(c):null;g=(new Date).getTime();null===g&&(g=
0);var s=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+d+g.toString());R=s;hc=h;ic=M;verbose_log("interrogate id="+R+" desc="+d);C=[];c={cmd:"cpwbot_validate_state",desc:d,required_fields:h,rejected_fields:M,id:R,validate_timeout:b,timestamp:g,proceed_on_interactive:jc(c)?1:0,interactive_fields:e};m&&(c.required_url=m);f&&(c.rejected_url=f);X=c;S=d;sendCS(a,c,"all");verbose_log("setup setimeout for "+b/1E3+" seconds finish_cpwbot_validate_state");setTimeout(function(){CPWbot_bg&&CPWbot_bg.finish_cpwbot_validate_state(a,
s,h,M,d)},b);return null}function Q(){return null}function Va(a,b,c,d){if(d||!CPWbot_bg.get_docaptchastate())b?m_last_overlay_msg=b:b=m_last_overlay_msg,c||(c=B),b={msg:b,symbolic:Y(c)},b=CPWbot_bg.JSON.stringify(b),sendCS(a,{cmd:"do_cpwbot_overlay",msg:b},g_CS_tops[a])}function kc(a){sendCS(a,{cmd:"hide_cpwbot_overlay"},"all");return!0}function lc(a){var b=null;if(!a)return b;"undefined"!=typeof a.generate_pref_overrides&&(b=a.generate_pref_overrides);return b}function mc(a){var b=0;if(!a)return null;
"undefined"!=typeof a.postacctmgmt_sleep&&(b=a.postacctmgmt_sleep);return b}function nc(a){var b=0;if(!a)return null;"undefined"!=typeof a.postrevealcpw_sleep&&(b=a.postrevealcpw_sleep);return b}function ub(a){var b=0;if(!a)return null;"undefined"!=typeof a.postreveallogin_sleep&&(b=a.postreveallogin_sleep);return b}function oc(a){var b=0;if(!a)return null;"undefined"!=typeof a.postlogout_sleep&&(b=a.postlogout_sleep);return b}function jc(a){var b=!1;if(!a)return null;"undefined"!=typeof a.proceed_on_interactive&&
(b=a.proceed_on_interactive?!0:!1,"0"===a.proceed_on_interactive&&(b=!1));return b}function vb(a){var b=0;if(!a)return null;"undefined"!=typeof a.post_login_submit_delay&&(b=a.post_login_submit_delay);return b}function wb(a){var b=0;if(!a)return null;"undefined"!=typeof a.session_timeout&&"number"==typeof a.session_timeout&&(b=a.session_timeout);return b}function Sa(a){var b=0;if(!a)return null;"undefined"!=typeof a.click_on_fields_on_fill&&(b=a.click_on_fields_on_fill?1:0);return b}function Ta(a){var b=
0;if(!a)return null;"undefined"!=typeof a.fill_password_fields_via_keys&&(b=a.fill_password_fields_via_keys?1:0);return b}function Wa(a){if(!a)return null;var b=DEFAULT_FILL_DELAY;"number"==typeof a.fill_field_delay&&(b=a.fill_field_delay);verbose_log("fill field delay : "+b);return b}function pc(a){var b=!1;if(!a)return null;"undefined"!=typeof a.document_complete_timeout&&(b=a.document_complete_timeout);return b}function n(a,b){var c=["DEBUG","INFO","WARN","ERR"];if(a<K||a>Xa)a=K;return g_isfirefox&&
lpisadmin||g_isdebug||g_isadmin?(c="["+c[a]+"] "+b+"\n",Ya+=c,verbose_log(c),write_history({cmd:"CPW",msg:c}),!0):!1}function qc(a,b){var c=!1;if(!b||!a)return debug&&L("validate_xpath: none"),c;try{var d=g_isfirefox?new a.defaultView.XPathEvaluator:new XPathEvaluator;if(!d&&debug)return L("NO XPATH EVALUATOR AVAILABLE ????"),!0;d.evaluate(b,a.documentElement,null,g_isfirefox?a.defaultView.XPathResult.FIRST_ORDERED_NODE_TYPE:XPathResult.FIRST_ORDERED_NODE_TYPE,null);c=!0}catch(f){console_error("error validating '"+
b+"', exception: "+f),c=!1}return c}function rc(a){var b=g_isfirefox?LP.getBrowser().selectedTab.linkedBrowser.contentDocument:document;if(!b||!a)return L("Bad Recipe: none"),!1;var c,d;if(!(!a?0:a.login_url))return L("Bad Recipe: no login url"),!1;if(!Y(a))return L("Bad Recipe: no symbolic"),!1;if(!a.field_info||0>=a.field_info.length)return L("Bad Recipe: no fields"),!1;if(!sc(a))return!1;var f=!1,m=!1,g=!1,e=!1,h=!1,j=!1,n=!1,q=!1,s=!1;for(c=0;c<a.field_info.length;c++)switch(d=a.field_info[c],
d.id_function){case FN_LOGIN:case FN_LOGIN_SUBMIT:case FN_PASSWORD:f=!0;break;case FN_CURRENT_PASS:case FN_NEW_PASS:case FN_NEW_PASS_CONFIRM:case FN_CPW_SUBMIT:h=!0;break;case FN_CPW_SUCCESS:case FN_CPW_SUCCESS_INVALID:j=!0;break;case FN_LOGIN_SUCCESS:case FN_LOGIN_SUCCESS_INVALID:g=!0;break;case FN_IS_LOGGED_IN:case FN_IS_LOGGED_IN_NEGATION:m=!0;break;case FN_NAVIGATE_TO_LOGOUT:q=!0}if(Ub(a)||Vb(a)||Qb(a))n=!0;if(Xb(a)||Wb(a)||Pb(a))e=!0;I(a)&&(s=!0);if(!f||!m||!g&&!e||!h||!q&&!s||!j&&!n)return L("Bad Recipe for "+
Y(a)+": has_login_fields?"+f+" has_logged_in_fields?"+m+" has_login_success_fields?"+g+" has_login_success_alt?"+e+" has_logout_field?"+q+" has_logout_alt?"+s+" has_cpw_fields?"+h+" has_cpw_success_fields?"+j+" has_cpw_success_alt?"+n),!1;for(c=0;c<a.field_info.length;c++)if(d=a.field_info[c],d.id_type==TYPE_XPATH){if(!qc(b,d.id_value))return L("Bad Recipe: bad xpath"),!1;if(d.id_value&&0<d.id_value.indexOf("@clas,"))return L("Bad Recipe: @clas mispell"),!1}else if(d.id_type==TYPE_ID||d.id_type==
TYPE_NAME)if(d.id_value&&(0<=d.id_value.indexOf("//")||0<=d.id_value.indexOf("text()")||0<=d.id_value.indexOf("contents(")))return L("Bad Recipe: xpath in non-xpath field def"),!1;return!0}function sc(a){var b,c,d,f=!0,m={id_function:1,id_value:1,id_type:1};if(!a.field_info||0>=a.field_info.length)return!1;for(c=0;c<a.field_info.length;c++){if((b=a.field_info[c])&&"number"!=typeof b.id_function)verbose_log(sprintf("field %s has invalid function '%s'",b.id_value,b.id_function)),f=!1;for(d in b)b.hasOwnProperty(d)&&
!m[d]&&(verbose_log(sprintf("found invalid field property '%s'",d)),f=!1)}m={jsfrag:1,jstype:1};if(a.jsfrags&&0<a.jsfrags.length)for(c=0;c<a.jsfrags.length;c++){if((b=a.jsfrags[c])&&"number"!=typeof b.jstype)verbose_log(sprintf("js with invalid type '%s'",b.jstype)),f=!1;for(d in b)b.hasOwnProperty(d)&&!m[d]&&(verbose_log(sprintf("found invalid javascript property '%s'",d)),f=!1)}m={length:1,maxlength:1,minlength:1,special:1,digits:1,upper:1,lower:1,mindigits:1};if(a.generate_pref_overrides)for(d in a.generate_pref_overrides)a.generate_pref_overrides.hasOwnProperty(d)&&
!m[d]&&(verbose_log(sprintf("found invalid generate preference '%s'",d)),f=!1);return f}function tc(){ia=ra=pa=ja=oa=da=ba=ea=!1}function uc(a,b){var c=b.docnum,d=b.url;if(null===p)return!1;(null===p[c]||"undefined"==typeof p[c])&&CPWbot_bg.clear_frame_score(a,c,d);p[c]+=2;return!0}function gc(a){if(null===p||null===a)return 0;var b,c=0,d;for(d in CS_table)CS_table.hasOwnProperty(d)&&(b=CS_table[d],b.tabid===a&&(b=b.docnum,(CPWbot_bg.skip_frame_by_score(b)||skip_CS_by_score(a,b))&&c++));return c}
function vc(a,b){null!==a&&null!==g_CS_tops[a]&&sendCS(a,{cmd:"do_result_div",msg:b},g_CS_tops[a])}function wc(a,b){var c=wb(b);c||(c=DEFAULT_SESSION_TIMEOUT);null!==T&&(0<T&&!isNaN(T))&&(c*=T);var d=CPWbot_bg.get_session();CPWbot_bg.session_timeout_st_id=setTimeout(function(){if(d!=CPWbot_bg.get_session())verbose_log("stale timeout");else{CPWbot_bg.mark_timestamp("session_timeout");var b=CPWbot_bg.get_timestamp("session_timeout")-CPWbot_bg.get_timestamp("initial_cycle");verbose_log(sprintf("session timeout at %6.2f seconds after T=0",
b/1E3));verbose_log("SESSION TIMEOUT WAKEUP");!sa&&!Ca&&x==a?(xc("timeout: a change is still running ? tabid="+a+"last state ="+h),CPWbot_bg.panic("session timeout")):(z(a),CPWbot_bg.cpwbot_cs_finish_complete(a))}},c)}function yc(a,b,c){verbose_log("B1: validate_login_form ");h="B1";var d=null,d=CPWbot_bg.validate_login_form(a,b,{aid:c.aid,recipe:b});if(null===d)return verbose_log("B1: validate_login_form / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true"),null;if(d)do_A4(a,b,c);else return CPWbot_bg.do_milestone(a,
wa,b,""),z(a),!1;return!0}function xa(a,b,c){setTimeout(function(){lploggedin&&CPWbot_bg&&CPWbot_bg.engine(a,b,c)},250)}function zc(a,b){var c=m_lastclick_metadata;Qa>pd&&verbose_log("too many click retries");c&&(n(F,"Retry Click"),verbose_log("tabid="+a+" id_type="+c.id_type+" id_value="+c.id_value),sendCS(a,c,b),Qa++)}function fa(a){return(new Date).getTime()>Zb&&!pb?(pb=!0,zc(a,"all"),!0):!1}function Ac(a,b){L(sprintf("[%s] time factor adjustment=%6.2f",Y(a),b));return!0}function Bc(){}function Cc(a,
b){CPWbot_bg.do_milestone(a,xb,b);z(a);CPWbot_bg.cpwbot_cs_finish_complete(a);return!0}function xc(a){CPWbot_bg&&(n(Xa,a),CPWbot_bg.phone_home(null,null,{severity:"fatal",msg:a}))}function Ba(a){n(qd,a);return CPWbot_bg.phone_home(null,null,{severity:"warning",msg:a})}function ya(a,b){var c;c=0<fc(b).length?!0:!1;c?CPWbot_bg.do_milestone(a,yb,b):(CPWbot_bg.do_milestone(a,zb,b),z(a))}function Y(a){return a?a.symbolic:""}function W(a){a||(a=100);return"undefined"==typeof Math?0:Math.floor(Math.random(a)+
10)}var Dc=this,Ec=0,h=null,x=null,ga=null,B=null,qa=0,X=null,R=null,S=null,Ab=null,na=null;e();var tb=null,C=[],Za=!1,$a=!1,ab=!1,bb=!1,E=!1,Ya="",sa=!1,Ca=!1,ea=!1,oa=!1,da=!1,ba=!1,ra=!1,ia=!1,ja=!1,pa=!1,p={},ca=!1,aa=!1,Bb=!1,Cb=!1,cb=!1,db=!1,eb=!1,ta=!1,fb=!1,gb=!1,qb=!1,hb=3,Db=4,Eb=5,Fb=6,Gb=7,yb=9,$b=68,ac=69,Fc=70,Gc=71,ec=74,cc=75,Da=129,wa=130,Hb=131,Ib=132,ib=134,Jb=137,xb=138,zb=139,Ea=141,j=[""];j[1]=gs("LastPass is loading...");j[2]=gs("LastPass is loading website...");j[hb]=gs("LastPass is logging in...");
j[Db]=gs("LastPass is changing your password now...");j[Eb]=gs("LastPass is changing your password now...");j[Fb]=gs("LastPass is changing your password now...");j[Gb]=gs("LastPass is changing your password now...");j[8]=gs("LastPass is logging in...");j[yb]=gs("The website needs you to enter information. Please switch to the tab and enter it.");j[63]=gs("Congratulations! Your password for %s was updated, and is now saved in your LastPass vault. Your change will sync on every device.");j[128]=gs("We're sorry. We were not able to change your password automatically for %s. Your password was not changed.");
j[248]=j[128]+" "+gs("The random password that was generated has been saved to your vault.");j[136]=j[128];j[133]=gs("Timed out waiting for the page to load.  Retry?");j[wa]=j[128];j[Da]=j[128];j[ib]=j[128];j[135]=j[128];j[Hb]=j[128];j[Ib]=j[128];j[Jb]=j[128];j[xb]=gs("Halt Requested");j[zb]=gs("Unable to proceed, the website does not allow automated password change.");j[140]=gs("Timed out");j[Ea]=j[128];"function"==typeof alertfrombg&&(this.alert=alertfrombg);g_isfirefox&&(this.alert=alert);this.JSON=
JSON;JSON||(this.JSON=LPJSON);this.get_pwchangestate=function(){return h};this.get_pwchangetabid=function(){return x};this.get_login_url=function(a){return!a?null:a.login_url};this.get_cpw_url=function(a){return!a?null:a.cpw_url};this.get_acctmgmt_url=function(a){return!a?null:a.acctmgmt_url};this.conditional_js_exec=function(a,b,c){return A(a,b,c)};this.show_cpwbot_overlay=function(a,b,c){return Va(a,b,c)};this.in_validate=function(){return X&&R&&null!=S&&""!=S&&"undefined"!=typeof S};this.in_validate_outer=
function(){return Dc.in_validate()||t||w};this.get_last_overlay_message=function(){return m_last_overlay_msg};this.get_fakeui_loggedout_url=function(a){a=a?a.fakeui_loggedout_url:null;return a};this.get_fakeui_loggedin_url=function(a){a=a?a.fakeui_loggedin_url:null;return a};this.reveal_cpw=function(a,b){if(!b)return!1;var c=b.recipe,d=b.payload,f=d.aid;if(!c||!d)return!1;L("reveal_cpw called after wait-for-document-complete tabid="+a);CPWbot_bg.mark_timestamp("reveal_cpw");n(F,"Reveal Change-Password Form");
h="D";$a=!1;A(a,c,Lb);var m=!c?null:c.cpw_url;if(m)return L("call cpw:loadurl with "+m),f=null,g_CS_tops&&(f=g_CS_tops[a],g_ischrome&&0!=f&&L("loadurl is not sending to docnum==0 ! "+f)),sendCS(a,{cmd:"loadurl",url:m},f),N=!0,verbose_log("m_in_loadurl set"),B=c,ga=d,$a=!0,null;ba=!1;if(d=J(c,FN_NAVIGATE_TO_CPW)){verbose_log("click on FN_NAVIGATE_TO_CPW field!");m=DEFAULT_CLICK_DELAY;"undefined"!=typeof c.cpw_delay&&(m=c.cpw_delay);ba=!0;L("now waiting for click_ack_D");var g=H(c);ma(a,d,m,g);CPWbot_bg.mark_timestamp("wait_for_click_ack_D")}d=
!1;c?"undefined"!=typeof c.reveal_cpw_js_delay&&(d=c.reveal_cpw_js_delay?!0:!1,"0"===c.reveal_cpw_js_delay&&(d=!1)):d=null;if(d&&($a=!0,nc(c)))return null;A(a,c,mb);if(b.didcallout)return L("end of reveal_cpw thread with callout to CS - hack Dpickup to resume for aid="+f),h="Dpickup",null;L("no callout to CS, so reveal_cpw does not end thread, returning to initiate");return!0};this.navigate_to_acctmgmt=function(a,b){if(!b)return!1;var c=b.recipe,d=b.payload,f=d.aid;L("navigate_to_acctmgmt called after wait-for-document-complete tabid="+
a);CPWbot_bg.mark_timestamp("acctmgmt_nav");h="C";if(!c)return!1;n(F,"Navigate to Account Management Page");ab=!1;A(a,c,Mb);var m=!c?null:c.acctmgmt_url;if(m)return L("call acctmgmt:loadurl with "+m),f=null,g_CS_tops&&(f=g_CS_tops[a]),sendCS(a,{cmd:"loadurl",url:m},f),N=!0,verbose_log("m_in_loadurl set"),B=c,ga=d,ab=!0,null;da=!1;if(d=J(c,FN_NAVIGATE_TO_ACCTMGMT)){verbose_log("click on FN_NAVIGATE_TO_ACCTMGMT field!");m=DEFAULT_CLICK_DELAY;"undefined"!=typeof c.acctmgmt_delay&&(m=c.acctmgmt_delay);
da=!0;L("now waiting for click_ack C");var g=H(c);ma(a,d,m,g);CPWbot_bg.mark_timestamp("wait_for_click_ack_C")}d=!1;c?"undefined"!=typeof c.navigate_acctmgmt_js_delay&&(d=c.navigate_acctmgmt_js_delay?!0:!1,"0"===c.navigate_acctmgmt_js_delay&&(d=!1)):d=null;if(d&&(ab=!0,mc(c)))return null;A(a,c,nb);if(b.didcallout)return L("end of navigate_to_acctmgmt thread with callout to CS - hack Cpickup to resume for aid="+f),h="Cpickup",null;g_v2engine||L("no callout to CS, so nav_to_acctmgmt does not end thread, returning to initiate");
return!0};this.trigger_cpw=function(a,b){if(gb)return!1;gb=!0;verbose_log("trigger_cpw entered");CPWbot_bg.mark_timestamp("trigger_cpw");if(!b)return!1;var c=b.recipe,d=b.payload;if(!c||!d)return!1;var f=Sa(c),m=Ta(c);L("trigger_cpw called after wait-for-document-complete tabid="+a);h="E";var g=d.aid,e=va(g),j="";if(e)j=e.url;else return Ba("given invalid aid - data consistency error?"),!1;A(a,c,Nb);var M=J(c,FN_CURRENT_PASS),q=J(c,FN_NEW_PASS),s=J(c,FN_NEW_PASS_CONFIRM),t=J(c,FN_CPW_SUBMIT),p=H(c),
y=15,w=1,u=1,v=1,x=0,z=1,D=0,E=1,B=null;g_isfirefox?(LP.lpprefsHasUserValue("genpw_passlen")&&(y=LP.lpprefsGetIntPref("genpw_passlen")),LP.lpprefsHasUserValue("genpw_upper")&&(w=LP.lpprefsGetBoolPref("genpw_upper")?1:0),LP.lpprefsHasUserValue("genpw_lower")&&(u=LP.lpprefsGetBoolPref("genpw_lower")?1:0),LP.lpprefsHasUserValue("genpw_digits")&&(v=LP.lpprefsGetBoolPref("genpw_digits")?1:0),LP.lpprefsHasUserValue("genpw_special")&&(x=LP.lpprefsGetBoolPref("genpw_special")?1:0),LP.lpprefsHasUserValue("genpw_mindigits")&&
(z=LP.lpprefsGetIntPref("genpw_mindigits")?1:0),LP.lpprefsHasUserValue("genpw_ambig")&&(D=LP.lpprefsGetBoolPref("genpw_ambig")?1:0),LP.lpprefsHasUserValue("genpw_reqevery")&&(E=LP.lpprefsGetBoolPref("genpw_reqevery")?1:0),LP.lpprefsHasUserValue("genpw_pronounceable")&&(B=LP.lpprefsGetBoolPref("genpw_pronounceable")?1:0)):(y=parseInt(lpGetPref("generate_length",y)),w=parseInt(lpGetPref("generate_upper",w)),u=parseInt(lpGetPref("generate_lower",u)),v=parseInt(lpGetPref("generate_digits",v)),x=parseInt(lpGetPref("generate_special",
x)),z=parseInt(lpGetPref("generate_mindigits",z)),D=parseInt(lpGetPref("generate_ambig",D)),E=parseInt(lpGetPref("generate_reqevery",E)),B=parseInt(lpGetPref("generate_pronounceable",B)));0==w&&(0==u&&0==v&&0==x)&&(w=u=v=1);var C=getpasswordfromacct(e);C.length>y&&(y=C.length);var k=lc(c);null!==k&&("undefined"!=typeof k.length&&null!==k.length&&(y=k.length),"undefined"!=typeof k.maxlength&&null!==k.maxlength&&y>k.maxlength&&(y=k.maxlength),"undefined"!=typeof k.minlength&&null!==k.minlength&&y<k.minlength&&
(y=k.minlength),"undefined"!=typeof k.special&&null!==k.special&&(x=k.special?1:0),"undefined"!=typeof k.digits&&null!==k.digits&&(v=k.digits?1:0),"undefined"!=typeof k.upper&&null!==k.upper&&(w=k.upper?1:0),"undefined"!=typeof k.lower&&null!==k.lower&&(u=k.lower?1:0),"undefined"!=typeof k.mindigits&&null!==k.mindigits&&(z=k.mindigits));n(F,"Generating a new password that is "+y+" chars long, "+(w?"with":"without")+" uppercase chars, "+(u?"with":"without")+" lowercase chars, "+(v?"with":"without")+
" numeric chars, "+(x?"with":"without")+" special chars, with at least "+z+" numbers,");y=(g_isfirefox?LP.lpCreatePass:lpCreatePass)(y,w,u,v,x,z,D,E,B);L("generated new password: "+(g_show_pw_in_logs||g_isadmin?y:"REDACTED"));L("saving "+(g_show_pw_in_logs||g_isadmin?y:"REDACTED")+" to "+j+" as generated password");g_isfirefox?ff_save_generated_password(y,j,!0,!0):savePassword(y,j,a,1);g_isfirefox?null!==LP.lpgenpwlist&&LP.lpgenpwlist.unshift(y):null!==g_genpws&&g_genpws.unshift(y);CPWbot_bg.do_milestone(a,
73,c);d.newpw=lpenc_acct(y,e,"undefined"==typeof g_shares?lpshares:g_shares);d.curpw=lpenc_acct(C,e,"undefined"==typeof g_shares?lpshares:g_shares);ga=d;Ab=d.newpw;n(F,"Filling Change-Password Form");d=Wa(c);j=rnd2=rnd3=rnd4=0;qb&&(j=W(),rnd2=W(),rnd3=W(),rnd4=W());e=0;M&&(e+=1,la(a,C,M,f,d*e+j,m,p));q&&(e+=1,la(a,y,q,f,d*e+j+rnd2,m,p));s&&(e+=1,la(a,y,s,f,d*e+j+rnd2+rnd3,m,p));t&&(ea=!0,L("now waiting for click_ack E"),p=null,"undefined"!=typeof c.trigger_cpw_delay&&(p=c.trigger_cpw_delay),verbose_log("trigger cpw delay : "+
p+" + "+d*e),f=p,f=null===p?d*e:p+d*e+rnd4,p=H(c),ma(a,t,f,p),CPWbot_bg.mark_timestamp("wait_for_click_ack_E"));pass;A(a,c,Ob);if(b.didcallout)return L("end of trigger_cpw thread with callout to CS - hack Epickup to resume for aid="+g),h="Epickup",null;L("no callout to CS, so trigger_cpw does not end thread, returning to initiate");return!0};this.navigate_to_login=function(a,b){if(!b)return!1;var c=b.recipe;h="B";Za=!1;if(!c)return!1;n(F,"Navigate to Login");var d=!c?null:c.login_url;if(d){L("call login:loadurl with "+
d);var f=null;g_CS_tops&&(f=g_CS_tops[a],g_ischrome&&0!=f&&L("loadurl is not sending to docnum==0 ! "+f));sendCS(a,{cmd:"loadurl",url:d},f);N=!0;verbose_log("m_in_loadurl set");B=c;ga=b;Za=!0;return null}if(g_v2engine)return!1;d=!1;c?"undefined"!=typeof c.reveal_login_js_delay&&(d=c.reveal_login_js_delay?!0:!1):d=null;if(d&&(Za=!0,ub(c)))return null;A(a,c,ob);return!0};this.check_is_logged_in=function(a,b){if(!b)return!1;var c={recipe:b,desc:"validate_website_is_loggedin",fn_required:jd,fn_rejected:kd,
fn_url_success:Q,fn_url_failed:Q};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_website_is_loggedin returns true, no wait ");return!0};this.validate_login_success=function(a,b){if(!b)return!1;A(a,b,Pb);var c={recipe:b,desc:"validate_login_success",fn_required:dd,fn_rejected:ed,fn_url_success:Xb,fn_url_failed:Wb};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),
null;L("validate_login_success returns true, no wait ");return!0};this.validate_login_entry_success=function(a,b){if(!b)return!1;A(a,b,Rc);var c={recipe:b,desc:"validate_login_entry_success",fn_required:fd,fn_rejected:gd,fn_url_success:Vc,fn_url_failed:Uc};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_login_entry_success returns true, no wait ");return!0};this.validate_cpw_success=function(a,b){if(!b)return!1;A(a,b,Qb);
var c={recipe:b,desc:"validate_cpw_success",fn_required:hd,fn_rejected:id,fn_url_success:Ub,fn_url_failed:Vb};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_cpw_success returns true, no wait ");return!0};this.validate_login_form=function(a,b){if(!b)return!1;var c={recipe:b,desc:"validate_login_form",fn_required:$c,fn_rejected:ad,fn_url_success:Q,fn_url_failed:Q};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=
!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_login_form returns true, no wait ");return!0};this.validate_cpw_form=function(a,b){if(!b)return!1;var c={recipe:b,desc:"validate_cpw_form",fn_required:Yc,fn_rejected:Zc,fn_url_success:Q,fn_url_failed:Q};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_cpw_form returns true, no wait ");return!0};this.validate_login_entry_form=function(a,b){if(!b)return!1;var c=
{recipe:b,desc:"validate_login_entry_form",fn_required:bd,fn_rejected:cd,fn_url_success:Q,fn_url_failed:Q};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_login_entry_form returns true, no wait ");return!0};this.revert_password=function(a,b){if(!b)return!1;alert("REVERT: TODO");return!0};this.initiate=function(){};this.cpwbot_cs_finish_complete=function(a){verbose_log("cpwbot_cs_finish_complete on tabid="+a);x!=a?null!==
x&&verbose_log("stale call: started up a new password change on different tab - ABORT - tabid=="+a+" g_pwchangetabid="+x):(null!==CPWbot_bg.session_timeout_st_id&&clearTimeout(CPWbot_bg.session_timeout_st_id),CPWbot_bg.session_timeout_st_id=null,null!==CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id),CPWbot_bg.docaptcha_si_id=null,CPWbot_bg.mark_timestamp("finish_complete"),CPWbot_bg.logout(),kc(a),CPWbot_bg.do_milestone(a,66,null))};this.finish_cpwbot_validate_state=function(a,
b,c,d,f){verbose_log("ENTERED finish_cpwbot_validate_state");var m=!1,e=!1;if(x!=a)return verbose_log("finish_cpwbot_validate_state: !tabid, abort"),!1;if(b!=R)return verbose_log("finish_cpwbot_validate_state: ignoring stale request, current validate is "+S+"/"+R+", stale req is "+f+"/"+b+" "),!1;var g=Ua(B),j=R;if(ca&&!aa)return ca=!1,aa=!0,L("finish_cpwbot_validate_state: reload1 extending timeout for "+f),setTimeout(function(){CPWbot_bg.finish_cpwbot_validate_state(a,j,c,d,f)},g),!1;verbose_log("finish_cpwbot_validate_state: closing out request "+
f+"/"+b);if(null===C)return verbose_log("finish_cpwbot_validate_state: dup, abort"),!1;if(null===g_CS[a])return lploggedin?(L("finish_cpwbot_validate_state: reload2 extending timeout for "+f),setTimeout(function(){CPWbot_bg.finish_cpwbot_validate_state(a,j,c,d,f)},g)):(verbose_log("finish_cpwbot_validate_state: tab "+a+" closed "),CPWbot_bg.panic("logged out?")),!1;g=tb;g_CS[a].length==C.length&&(e=!0);for(b=0;b<C.length;b++)if(C[b]){m=!0;break}e||verbose_log("finish_cpwbot_validate_state: sent out "+
g_CS[a].length+" messages, received "+C.length+" messages, skipped "+g+" frames");b=e=0;for(var n in p)p.hasOwnProperty(n)&&!this.skip_frame_by_score(n)&&(e++,C[n]&&b++);b<e&&console_warn("CASE : still waiting to hear from important frames, expected to hear from "+e+", heard from "+b);m||(n=JSON.parse(c),e=JSON.parse(d),0==n.length&&0<e.length&&(m=!0));X=C=null;tb=0;g_v2engine?(w=t=!1,L("VALIDATE_IN_DOCWAIT=false"),O=m,s={},console_log("finish_cpwbot_validate_state complete result="+m+", wait for next engine cycle at "+
h),pass):(m={aid:qa,recipe:B,validate_result:m},console_log("finish_cpwbot_validate_state resumed initiate with state="+h),CPWbot_bg.initiate(a,m,h));return!1};this.chk_cpw_resume=function(){return!1};this.cpwbot_validate_state_result_handler=function(a,b){var c=!1;if(CPWbot_bg&&null!==x&&a==x){var d=b.docnum;if("undefined"!=typeof d&&CPWbot_bg&&null!==C){var f=JSON.parse(b.result);JSON.parse(b.rejected_fields);JSON.parse(b.required_fields);var m=!1,e=null;b.result_obj&&(e=JSON.parse(b.result_obj));
var g=b.desc,j=b.id;L("received a "+g+" validate result from ["+a+"]["+d+"]["+b.url+"]["+b.docstate+"]["+b.state+"]="+f);if(S&&S!=g||R&&R!=j)L("unexpected validate msg - perhaps from the last validate call.... ignoring it"),L("got "+g+"/"+j+" expected "+S+"/"+R);else{j=!1;if(e){b.required_url&&n(K,"["+a+"]["+d+"] validate given success_url, result="+e.url_success_match+" when matching success url = "+b.required_url);b.rejected_url&&n(K,"["+a+"]["+d+"] validate given bad_url, result="+e.url_failure_match+
" when matching failure url = "+b.rejected_url);n(K,sprintf("[%s][%d] %s found %d/%d success fields, given %d invalid fields and %s invalid fields, %s captcha-ish fields",a,d,g,e.num_ok_matches,e.num_okfields,e.num_badfields,e.found_bad_match?"found":"did not find",e.found_interactive?"found":"did not find"));if(0<e.num_ok_matches)uc(a,b),e.found_interactive&&(j=!0);else if(e.found_bad_match)uc(a,b),j=!0;else{var q=b.docnum,u=b.url;null!==p&&((null===p[q]||"undefined"==typeof p[q])&&CPWbot_bg.clear_frame_score(a,
q,u),p[q]+=-2)}e.found_interactive&&(m=!0)}C[d]=f;d=gc(a);if(null===g_CS[a]&&CPWbot_bg&&X)L("interrupted by a page load/refresh, reissuing validate for state "+h),C=[],sendCS(a,X,"all");else if(g_CS[a]&&g_CS[a].length==C.length&&(c=!0),null===g_CS[a]?verbose_log("tab is reloading but cannot retry validate ? WTF"):verbose_log("["+a+"] "+g+" sent "+g_CS[a].length+" messages, heard from "+C.length+", skipped "+d+" frames"),f||c||j||m)C=null,null===f&&(f=!1),X=null,w=t=!1,L("VALIDATE_IN_DOCWAIT=false"),
L("validate complete, result is "+f+" current state="+h),O=f,s=e}}else debug&&L("stale2? validate result tabid="+a+" g_pwchangetabid="+x+" g_pwchange_validate_desc="+S)}else debug&&L("stale1? validate result tabid="+a+" g_pwchangetabid="+x+" g_pwchange_validate_desc="+S)};this.cpwbot_finish_ack_handler=function(a,b){if(null!==a&&b){sendCS(a,{cmd:"cpwbot_finish_ack"},"all");sendCS(a,{cmd:"hide_cpwbot_overlay"},"all");if(g_CS_tops[a]!=b.docnum)if(null==g_CS_tops[a]||"undefined"==typeof g_CS_tops[a])console_error("webpage has not finished loading");
else{console_error("WTF : top "+g_CS_tops[a]+" but docnum is "+b.docnum);var c=getcsinfo(a,b.docnum),d=getcsinfo(a,g_CS_tops[a]);d&&verbose_log("["+g_CS_tops[a]+"] topdoc is "+d.url);c&&verbose_log("["+b.docnum+"] other doc is "+c.url);c&&c.parent_docnum==c.docnum?verbose_log("CS table says that "+b.docnum+" is top"):d&&d.parent_docnum==d.docnum?verbose_log("CS table says that "+g_CS_tops[a]+" is top"):verbose_log("CS table mismatch, or reloading ? ")}CPWbot_bg.cpwbot_cs_finish_complete(a)}};this.cpwbot_skip_url=
function(){return!1};this.destination_tab=this.originating_tab=this.destination_tabid=this.originating_tabid=null;this.logout=function(){R=S=X=ga=B=qa=h=null;Ec=0;Ab=x=null;e();sa=Ca=!1;p=null;aa=ca=!1;na=null;this.clear_event_queue();pa=ea=ja=ba=da=ia=ra=!1};this.initialize=function(a){a?(x=a.tabid,debug&&(Hc=a.tabid),B=a.recipe,qa=a.aid,h=0,e(),Ca=ea=sa=!1,g_robots_txt&&sendCS(a.tabid,{cmd:"get_robots_txt"},g_CS_tops[a.tabid]),p={},aa=ca=!1,na=null,Fa="",fb=ta=eb=db=cb=Cb=Bb=!1,jb=0,CPWbot_bg.clear_event_queue(),
T=1,tc(),gb=!1,CPWbot_bg.broken_hearted_st_id=null,ua=za=Ga=N=!1,this.cpw_dialog_minimize_state=Qa=0):console_error("passed invalid params")};this.pwchangetabid_is_still_valid=function(){if(!CPWbot_bg)return!1;var a=x;return null!==a&&g_CS&&"undefined"!=typeof g_CS[a]&&null!==g_CS[a]?!0:!1};this.panic=function(a){a||(a="UNEXPECTED ERROR");L("panic="+a+", g_pwchangetabid == "+x);CPWbot_bg.do_milestone(x,128,B,a);z(x);CPWbot_bg.cpwbot_cs_finish_complete(x)};this.setmsg_cpwbot_overlay=function(a,b){Va(a,
b)};this.initiate_on_complete=function(a,b,c){var d=null;if(!g_cpwbot||!CPWbot_bg||45<c)return CPWbot_bg.do_milestone(a,133,m,"initiate_on_complete"),CPWbot_bg.panic("TIMEOUT-initiate"),null;var f=b.aid,m=b.recipe;if("undefined"==typeof c||null===c)c=1;if(!rc(m)){var d=va(f),e="(null)";d&&d.url&&(e=this.JSON.stringify(d.url));n(Xa,"Bad Recipe");f="Error for recipe on aid="+f+", url="+e;CPWbot_bg.phone_home(null,null,{severity:"fatal",msg:"Bad Recipe"});CPWbot_bg.panic(f);return null}if(Aa)Cc(a,m);
else{(m=pc(m))||(m=900);var g=g_CS_tops[a];if(null!==g&&(d=getcsinfo(a,g_CS_tops[a]))&&"complete"==d.docstate)return CPWbot_bg.mark_timestamp("doc_complete"),ping(a),d=c?c*m/1E3:0,isNaN(d)&&verbose_log("WTF NaN: ctr="+c+" url="+e+" aid="+f),u&&(f=u.doc_complete-u.openurl_callback,0<f&&(0!=u.doc_complete&&u.openurl_callback)&&(d=f/1E3)),0<d&&n(K,"Waited "+d+" seconds for document-complete before calling initialize_engine"),CPWbot_bg.initialize_engine(a,b);if(Aa||!lploggedin)return L("abort wait-for-doc-complete initiate"),
!1;null!==g?ping(a,g):ping(a);verbose_log("waiting for tabid "+a+" topdocnum="+g+" docstate="+(d?d.docstate:"null"));setTimeout(function(){CPWbot_bg.initiate_on_complete(a,b,c+1)},m);return!0}};this.get_user_debug_messages=function(){return Ya};var K=0,F=1,qd=2,Xa=3;this.userlog=function(a,b){return n(a,b)};this.click_ack_handler=function(a,b){var c=b.msgid,d=b.found;L("[T:"+a+"][D:"+b.docnum+"] cpwbot click_ack on "+b.id_value+" found="+d+" url="+b.url+" docstate="+b.docstate+" pwchangestate="+b.pwchangestate);
if(na!=c)return console_error("response for last click request overlaps current click-wait, ignoring it, found="+d),L("m_pwchange_last_click_field_id="+na),L("found="+d+" msgid = "+c),d&&console_error("Bad Mojo"),!0;d&&(ea&&(ea=!1),oa&&(oa=!1),ba&&(ba=!1),da&&(da=!1),ra&&(ra=!1),ia&&(ia=!1),ja&&(ja=!1),pa&&(pa=!1));return!0};this.fill_ack_handler=function(a,b){verbose_log(sprintf("[%s][%s] cpwbot fill ack on %s found=%s docstate=%s url=%s req_id=%s",a,b.docnum,b.id_value,b.found,b.docstate?b.docstate:
"null",b.url?b.url:"null",b.req_id?b.req_id:"null"));return!0};this.js_ack_handler=function(a,b){var c="";try{c=JSON.parse(b.result)}catch(d){console_warn("js_ack_handler: "+d)}verbose_log(sprintf("[%s][%s] cpwbot js ack result=%s docstate=%s url=%s req_id=%s",a,b.docnum,c?ofa(c):"null",b.docstate?b.docstate:"null",b.url?b.url:"null",b.req_id?b.req_id:"null"));return!0};this.check_for_robots=function(){};this.check_robot_txt=function(a,b){if(g_robots_txt){if(!a)return!0;if(null===b)g_tmp_recipe=a;
else{for(var c,d=0,f=b.split("\n"),e=!1,g=!1,d=0;d<f.length;d++){c=f[d];if(0==c.length&&""==c||"\r"==c)g=e=!1;"#"!=c.charAt(0)&&(0==c.indexOf("User-agent: LastPass")?e=!0:0==c.indexOf("User-agent: *")?e=!0:0==c.indexOf("Disallow: /")&&(g=!0))}return e&&g?!1:!0}}};this.score_frame=function(a,b){var c=b.docnum,d=b.url,f,e=0,g=lp_gettld_url(d),h=0,j="doubleclick.net appads.com crwdcntrl.net googleadservices.com quantserve.com questionmarket.com advertising.com zedo.com checkm8.com zvents.com doubleclick.com yldmgrimg.net optmd.com casalemedia.com scorecardresearch.com quotemedia.com tacoda.net daylife.com brightcove.com wibiya.com clickability.com stats.com google-analytics.com adfusion.com 2mdn.net adsonar.com everyclick.com shopica.com yeah.com vectorportal.com cnomy.com phpbb.com tracking101.com revsci.net revsci.com atdmt.com mmismm.com googlesyndication.com 247realmedia.com pointroll.com bluekai.com serving-sys.com vizu.com cleanprint.com outbrain.com tweetmeme.com visiblemeasures.com starwave.com kaango.com gabriels.net overture.com yieldmanager.net 2mdn.com eyewonder.com imgdownloads.com liverail.com adnxs.com addthis.com addthiscdn.com imshopping.com adtech.de 2o7.net glanceguide.com performgroup.com undertone.com undertonevideo.com martiniadnetwork.com chartbeat.net omtrdc.net zoomflow.com crowdscience.com imrworldwide.com fwmrm.net tremormedia.com webtrends.com adzerk.net adzerk.com qubitproducts.com maxymiser.net maxymiser.com newrelic.com mathtag.com adroll.com criteo.com liveperson.com getclicky.com sitemeter.com displaymarketplace.com yieldmanager.com media6degrees.com betrad.com 360yield.com adpredictive.com burstnet.com adtechus.com adsafeprotected.com turn.com contextweb.com p-td.com lijit.com rubiconproject.com ru4.com admeld.com openx.net pubmatic.com localyokelmedia.com qnsr.com wrating.com audienceiq.com mydas.mobi mopub.com visualrevenue.com adsymptotic.com admob.com adtrking.com 4dsply.com adshostnet.com adziff.com 33across.com vindicosuite.com securepaths.com taboola.com trk4.com crwdcntrl.com connexity.com connexity.net effectivemeasure.net visualdna.com amazon-adsystem.com 4dsply.com adblade.com doubleverify.com technoratimedia.com adjuggler.com opbandit.com iesnare.com adexcite.com adadvisor.net agkn.com dntx.com revenuehits.com tribalfusion.com".split(" "),
n="ads.cnn.com metrics.post-gazette.com ads.nwsource.com adbox.sina.com.cn ads.sina.com.cn ad.afy11.net avatar.cnn.com ads.cnn.com metrics.apple.com trailers.apple.com metrics.philly.com adsatt.espn.go.com player.ooyala.com seg.sharethis.com edge.sharethis.com bender.spoutable.com engine.spoutable.com".split(" "),q="facebook.com/plugins facebook.com/connect/xd_arbiter youtube.com/embed/ platform.twitter.com/widget platform.twitter.com/tweet_button libsyn.com/embed amazon.com/gp/widget".split(" ");
g_CS_tops&&g_CS_tops[a]==b.docnum&&(e=100);for(f=0;f<j.length;f++)if(g==j[f]){e=-100;h=1;break}if(!h)for(f=0;f<n.length;f++)if(0<=d.indexOf(n[f])){e=-100;h=1;break}if(!h)for(f=0;f<q.length;f++)if(0<=d.indexOf(q[f])){e=-100;break}p&&(p[c]=e);return e};this.score_topdoc=function(a,b,c){if(null===p)return!1;(null===p[b]||"undefined"==typeof p[b])&&CPWbot_bg.clear_frame_score(a,b,c);if(a=getcsinfo(a,b))if((state_param=a.flags)&&state_param.has_frameset)return!0;p[b]+=100;return!0};this.clear_frame_score=
function(a,b){if(null===p)return!1;p[b]=0;return!0};this.reset_scores=function(){p=null;return!0};this.skip_frame_by_score=function(a){if(null===p||null===a)return!0;L("skip? docnum ="+a+" score="+p[a]);return 0>p[a]};this.recompute_scores_for_tab=function(){return!0};this.retry_validate=function(a,b){null===b&&(b="all");X&&(C=[],sendCS(a,X,b))};this.wait_for_doc_complete=function(a,b,c,d,f,e){function g(a){return s?"complete"==a||"interactive"==a:"complete"==a}var j,q=d.aid,p=null,s=jc(d.recipe);
f||(f=0);var u=pc(d.recipe);u||(u=900);var t=g_CS_tops[a];"undefined"==typeof t&&(t=null);if(null===b||"undefined"==typeof b)b=t;if(null!==b&&(j=getcsinfo(a,b)))if(p=j.docstate,g(j.docstate)&&g(e))return e=f?f*u/1E3:0,isNaN(e)&&verbose_log("WTF NaN: recursion_ctr="+f+" aid="+q),0<e&&n(K,sprintf("Waited %d seconds for %s on [tabid:%s][docnum:%d] to execute %s",e,s?"interactive":"complete",a,b,d.desc)),null!==CPWbot_bg.get_pwchangetabid()&&CPWbot_bg.in_validate()&&(w=!1,L("WAITED DONE, calling "+d.desc+
" VALIDATE_IN_DOCWAIT=false")),c(a,d);if(Aa||!lploggedin||null===h)return L("abort wait-for-doc-complete "+d.desc),!1;ping(a);verbose_log("waiting for tabid "+a+" topdocnum="+t+" passed_docnum="+b+" docstate="+(j?j.docstate:"null")+" last_state="+e);b!=t&&(console_error("edge case - top docnum changed due to page reload?  will wait for that instead"+b+"!="+t),b=t);setTimeout(function(){lploggedin&&CPWbot_bg&&CPWbot_bg.wait_for_doc_complete(a,b,c,d,f+1,p)},u);return!0};this.should_wait_for_document_complete=
function(a,b){if(null===a||!b)return!1;var c=b.desc,d=b.recipe,f=!0,e=b.fn_url_failed,g=b.fn_url_success,h=b.fn_required,j=b.fn_rejected,h=h?h(d):[],d=j?j(d):[],j=b.target_url,n=b.target_field,q=b.target_js;if(!("undefined"==typeof j||null===j)||!("undefined"==typeof n||null===n)||!("undefined"==typeof q||null===q))f=!1;if(f){if(0==h.length&&0==d.length&&!g&&!e)return L("should_wait returns false, WARN: "+c+" has no field or url criteria defined to validate against"),!1}else if(!j&&!n&&!q)return L("should_wait returns false, no wait criteria, "+
c),!1;L("should_wait returns true for "+c+" is_validate="+f);return!0};this.handle_challenge=function(){};this.validate_challenge_page=function(a,b){if(!b)return!1;var c={recipe:b,desc:"validate_challenge_form",fn_required:ld,fn_rejected:md,fn_url_success:Xc,fn_url_failed:Wc};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_challenge_form returns false, no criteria to check, no wait");return!1};this.force_validate_retry=function(a){ca=
a};this.validate_challenge_success=function(a,b){if(!b)return!1;A(a,b,Nc);var c={recipe:b,desc:"validate_challenge_success",fn_required:nd,fn_rejected:od,fn_url_success:Q,fn_url_failed:Q};if(CPWbot_bg.should_wait_for_document_complete(a,c))return t=!0,CPWbot_bg.wait_for_doc_complete(a,null,$,c),null;L("validate_challenge_success returns true, no wait ");return!0};var Fa="";this.set_dialog_msg=function(a){Fa=a;return!0};this.get_dialog_msg=function(){return Fa};this.clear_dialog_msg=function(){Fa=
"";return!0};this.get_failstate=function(){return cb};this.get_okstate=function(){return db};this.get_captchastate=function(){return eb};this.get_docaptchastate=function(){return ta};this.get_brokenheartstate=function(){return fb};this.get_failpwsavedstate=function(){return Ha};this.get_fail_pending=function(){return sa};this.get_success_pending=function(){return Ca};this.show_selenium_ok=function(a){vc(a,"OK")};this.show_selenium_fail=function(a){vc(a,"FAIL")};this.preinit=function(){h="preinit";
e();Ya=Fa="";null!==CPWbot_bg.broken_hearted_st_id&&clearTimeout(CPWbot_bg.broken_hearted_st_id);CPWbot_bg.broken_hearted_st_id=null;Ha=db=fb=cb=ta=eb=Aa=!1};this.do_milestone=function(a,b,c,d){var f=null;c||(c={symbolic:""});if("undefined"==typeof d||null===d)d="";if("undefined"!=typeof Date){var e="",g=(new Date).toString();j[b]&&((f=Y(c))||(f=gs("unnamed site")),f=sprintf(j[b],f));switch(b){case 1:case 2:break;case hb:case 8:break;case Db:verbose_log("C: GOTO ACCTMGMT ");break;case Eb:verbose_log("D: REVEAL");
break;case Fb:verbose_log("E: TRIGGER");break;case Gb:verbose_log("F: VALIDATE");break;case yb:Ra(a,c,ga);A(a,c,Sc);ta=!0;g_isfirefox&&Va(a,gs("The website needs you to enter information. Please close this overlay and enter it."),c,!0);kc(a);CPWbot_bg.session_timeout_st_id&&(clearTimeout(CPWbot_bg.session_timeout_st_id),CPWbot_bg.session_timeout_st_id=null);CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id);CPWbot_bg.docaptcha_si_id=setInterval(function(){ta&&$(a,{desc:"docaptcha",
recipe:c,fn_required:fc})},1E3);break;case 63:n(F,"Saved and Replaced");db=!0;if(debug||g_isdebug)n(F,"showing selenium ok result"),CPWbot_bg.show_selenium_ok(a);Ca=!0;CPWbot_bg.mark_timestamp("success");break;case 65:g_v2engine?n(F,sprintf("[%s] v2 %s",g,gs("BEGIN"))):n(F,sprintf("[%s] %s",g,gs("BEGIN")));break;case 66:g_v2engine?n(F,sprintf("[%s] v2 %s",g,gs("End").toUpperCase())):n(F,sprintf("[%s] %s",g,gs("End").toUpperCase()));break;case 67:verbose_log("USER IS ALREADY LOGGED IN, SKIP LOGIN STATE");
n(F,"Appears to be Logged Into Site");break;case cc:case $b:n(F,"Filling Login Form");break;case ec:case ac:n(F,"Submit Login Form");break;case Fc:n(F,"Going to Login");verbose_log("B: GOTO LOGIN");break;case Gc:n(F,"Perform Logout");break;case 72:1!=T&&n(F,sprintf("Adjusting for %s site, %6.2f",1<T?"slow":"fast",T));break;case 73:Ha=!0;n(F,"Generated Random Password and Saved to Vault");break;case 128:e="UNEXPECTED ERROR";break;case Hb:e="FILL LOGIN FORM [PW CHALLENGE] FAILED!";break;case Ib:e="SUBMIT LOGIN FORM [PW CHALLENGE] FAILED!";
break;case ib:e="Expected Change-Password Form";break;case 135:e="Change Password Failed";break;case wa:e="Expected Login Form";break;case Da:case Ea:e="Login to Website Failed!";break;case 136:e="Unable to Save New Password";break;case Jb:e="Unable to Log Out of Website";break;case 133:e=gs("Timed out waiting for the page to load.  Retry?");fb=!0;break;case 140:e="Session Timeout";break;case xb:e="Halt Requested";break;case zb:eb=!0;e="Interaction required; cannot proceed";break;default:f=""}if(128==
(b&128)){cb=!0;n(Xa,e);if(debug||g_isdebug)n(F,"showing selenium fail result"),CPWbot_bg.show_selenium_fail(a);sa=!0;CPWbot_bg.mark_timestamp("fail");d={severity:"fatal",msg:sprintf("%s[debug=%s]",e,d)};CPWbot_bg.phone_home(a,c,d);Ha&&(f=sprintf(j[248],Y(c)))}else 64==(b&64)&&(f="");f&&(Va(a,f,c),CPWbot_bg.set_dialog_msg(f));CPWbatch&&CPWbatch.cpw_get_batchjob_state();CPWbatch&&CPWbatch.conditional_website_status_update({tabid:a,recipe:c,state:b,msg:f});return!0}};var Ic=null,ha=null,sb=null,t=!1,
t=!1,jb=0,ka=[],N=!1,Ga=!1,za=!1,ua=!1,kb=!1,Ia=!1,Ja=!1,Ka=!1,La=!1,Ma=!1,Na=!1,w=null,O=null,s={},U=null,hc=null,ic=null,Hc=null,Zb=null,pb=null,Qa=0,pd=10,Kb=null,Aa=!1,Ha=!1;this.docaptcha_si_id=this.session_timeout_st_id=this.broken_hearted_st_id=null;this.engine=function(a,b,c){var d,f;function e(a){debug&&(a=sprintf("[%s][%s] : %s",(new Date).toString(),"engine",a),console_log(a))}function g(a,b,c){var d;d={aid:c.aid,recipe:c.recipe};verbose_log("do_C "+h);CPWbot_bg.do_milestone(a,Db,b);d=
{desc:"navigate_to_acctmgmt",didcallout:!1,payload:d,recipe:b,target_field:J(b,FN_NAVIGATE_TO_ACCTMGMT),target_js:Mb(b)+""+nb(b),target_url:!b?null:b.acctmgmt_url};CPWbot_bg.should_wait_for_document_complete(a,d)?(L("wrapped navigate_to_acctmgmt around wait-for-document-complete"),za=d.didcallout=!0,CPWbot_bg.wait_for_doc_complete(a,null,function(a,b){L("Cnav milestone");h="Cnav";U=b},d),d=null):(d.didcallout=!1,L("execute navigate_to_acctmgmt, no wait "),d=CPWbot_bg.navigate_to_acctmgmt(a,d));if(null===
d)return L("callout to CS : navigate_to_acctmgmt"),d;!1===d&&console_error("C error");L("execute navigate_to_acctmgmt, no wait ");return q(a,b,c)}function j(a,b,c){E=!1;var d=mc(b);d||(d=2500);if(d&&!Ka)return h="Csleep",L("C sleeping "+d),E=!0,ha=Z+d,Ka=!0,null;Ka=!0;ab&&A(a,b,nb);return q(a,b,c)}function q(a,b,c){verbose_log("do_D "+h);var d;d={aid:c.aid,recipe:c.recipe};ua=!1;CPWbot_bg.do_milestone(a,Eb,b);d={desc:"reveal_cpw",payload:d,recipe:b,didcallout:!1,target_field:J(b,FN_NAVIGATE_TO_CPW),
target_js:Lb(b)+""+mb(b),target_url:!b?null:b.cpw_url};CPWbot_bg.should_wait_for_document_complete(a,d)?(L("wrapped reveal_cpw around wait-for-document-complete"),ua=d.didcallout=!0,CPWbot_bg.wait_for_doc_complete(a,null,function(a,b){L("Dreveal milestone");h="Dreveal";U=b},d),d=null):(d.didcallout=!1,L("execute reveal_cpw, no wait "),d=CPWbot_bg.reveal_cpw(a,d));if(d)return L("execute reveal_cpw, no wait "),B(a,b,c);L("callout to CS : reveal_cpw");return d}function p(a,b,c){E=!1;var d=nc(b);d||(d=
2500);if(d&&!La)return h="Dsleep",L("D sleeping "+d),E=!0,ha=Z+d,La=!0,null;La=!0;$a&&A(a,b,mb);L("entered do_D1");d={aid:c.aid,recipe:b};h="D1";var e=null,e=CPWbot_bg.validate_cpw_form(a,b,d);null===e?(verbose_log("D1: validate_cpw_form / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true"),a=null):a=e?void 0:v(a,b,c);return a}function v(a,b,c){var d={aid:c.aid,recipe:b};h="D2";var e=null,e=CPWbot_bg.validate_login_form(a,b,d);if(null===e)return w=!0,L("VALIDATE_IN_DOCWAIT=true"),verbose_log("D2: validate_login_form / CS callout "),
null;if(aa)return x(a,b,c);CPWbot_bg.do_milestone(a,ib,b,"");z(a);return!1}function x(a,b,c){h="D4";verbose_log("D4: FILL LOGIN/CHALLENGE");var d=null,d=Ra(a,b,P);if(!d)return CPWbot_bg.do_milestone(a,Hb,b,""),z(a),!1;verbose_log("D5: SUBMIT LOGIN");h="D5";var d=1100,e=vb(b);e&&(d=e);d&&verbose_log("waiting "+d+" ms after login waiting for site to bootstrap");e=rb(a,b,P);!1===e?(CPWbot_bg.do_milestone(a,Ib,b,""),z(a),a=!1):null===e?(d&&(E=!0,ha=Z+d),a=null):a=B(a,b,c);return a}function B(a,b,c){verbose_log("do_E "+
h);var d;d={aid:c.aid,recipe:c.recipe};CPWbot_bg.do_milestone(a,Fb,b);d={desc:"trigger_cpw",payload:d,recipe:b,target_field:J(b,FN_CPW_SUBMIT),target_js:Nb(b)+""+Ob(b),target_url:null};CPWbot_bg.should_wait_for_document_complete(a,d)?(L("wrapped trigger_cpw around wait-for-document-complete"),Ga=d.didcallout=!0,CPWbot_bg.wait_for_doc_complete(a,null,function(a,b){L("Etrigger milestone");h="Etrigger";U=b},d),d=null):(d.didcallout=!1,L("execute trigger_cpw, no wait "),d=CPWbot_bg.trigger_cpw(a,d));
if(d)return L("execute trigger_cpw, no wait "),C(a,b,c);L("callout to CS : trigger_cpw");return d}function C(a,b,c){E=!1;var d;d=0;b?"undefined"!=typeof b.posttrigger_sleep&&(d=b.posttrigger_sleep):d=null;d||(d=2500);if(d&&!Ma)return h="Esleep",L("E sleeping "+d),E=!0,ha=Z+d,Ma=!0,null;Ma=!0;c.validate_result=null;CPWbot_bg.mark_timestamp("verify_cpw");CPWbot_bg.do_milestone(a,Gb,b);h="F";null===CPWbot_bg.validate_cpw_success(a,b,P)?(verbose_log("F: VALIDATE callout to CS"),w=!0,L("VALIDATE_IN_DOCWAIT=true"),
a=null):(verbose_log("F: VALIDATE no callout to CS"),xc("no verify-cpw criteria defined"),CPWbot_bg.panic("fail"),a=!1);return a}function y(a,b,c){CPWbot_bg.do_milestone(a,hb,b);var d=lb(b);return d?(h="A3R",verbose_log("A3R: login-form-reveal"),c=DEFAULT_CLICK_DELAY,"undefined"!=typeof b.login_reveal_delay&&(c=b.login_reveal_delay),ra=!0,L("now waiting for click_ack A3R"),b=H(b),ma(a,d,c,b),CPWbot_bg.mark_timestamp("wait_for_click_ack_A3R"),null):I(a,b,c)}function I(a,b,c){L("post_A3R");E=!1;var d=
ub(b);verbose_log("A3R sleepval="+d);d||(d=1E3);if(d&&!Ia)return h="A3Rsleep",L("A3R sleeping "+d),E=!0,ha=Z+d,Ia=!0,null;Ia=!0;c.validate_result=null;verbose_log("calling reveal JS after A3 state");A(a,b,ob);return K(a,b,c)}function K(a,b,c){CPWbot_bg.do_milestone(a,hb,b);var d=!0;"undefined"!=typeof c.check_login_entry_form&&(d=c.check_login_entry_form?!0:!1);h="A3";if(d){var d=[],e=[FN_LOGIN_ENTRY_USERNAME,FN_LOGIN_ENTRY_PASSWORD,FN_LOGIN_ENTRY_SUBMIT],f;for(f=0;f<e.length;f++){var g=D(b,e[f]);
g&&0<g.length&&(d=d.concat(g))}}if(d){verbose_log("M: validate_login_entry_form");CPWbot_bg.mark_timestamp("login_entry");h="M";d=null;verbose_log("calling validate_login_entry_form");d=CPWbot_bg.validate_login_entry_form(a,b,P);if(null===d)return verbose_log("M: validate_login_entry_form / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true"),null;verbose_log("M: validate_login_entry_form returns "+d+" no call to CS")}verbose_log("A3: validate_login_form");h="A3";d=null;verbose_log("calling validate_login_form");
d=CPWbot_bg.validate_login_form(a,b,P);if(null===d)return verbose_log("A3: validate_login_form / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true"),null;verbose_log("A3: validate_login_form returns "+d+" no call to CS");return d?Q(a,b,c):Y(a,b,c)}function Q(a,b,c){CPWbot_bg.mark_timestamp("login_cpw");verbose_log("A4: FILL LOGIN");h="A4";var d=null,d=Ra(a,b,P);if(!d)return CPWbot_bg.do_milestone(a,wa,b,""),z(a),!1;verbose_log("A5: SUBMIT LOGIN");h="A5";var d=1100,e=vb(b);e&&(d=e);d&&verbose_log("waiting "+
d+" ms after login waiting for site to bootstrap");e=rb(a,b,P);!1===e?(CPWbot_bg.do_milestone(a,Da,b,""),z(a),a=!1):null===e?(d&&(E=!0,ha=Z+d),a=null):a=W(a,b,c);return a}function W(a,b,c){verbose_log("A2: validate_login_success ");h="A2";var d=null,d=CPWbot_bg.validate_login_success(a,b,P);if(null===d)return verbose_log("A2: validate_login_success / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true"),null;verbose_log("A2: validate_login_success "+d+" no CS callout ");if(d)g_cpw_do_fakeui?(b&&(c&&null!==
a)&&g_cpw_do_fakeui&&(h="FKLL0",verbose_log("entered do_logged_in_fake_ui")),d=0*Wa(b)+1021,setTimeout(function(){g(a,b,c)},d)):g(a,b,c);else return CPWbot_bg.do_milestone(a,Da,b,V),z(a),retval}function Y(a,b,c){CPWbot_bg.mark_timestamp("navlogin_cpw");Ec++;CPWbot_bg.do_milestone(a,Fc,b);CPWbot_bg.navigate_to_login(a,{aid:c.aid,recipe:c.recipe})&&ca(a,b,c)}function ca(a,b,c){verbose_log("post_B");E=!1;var d=ub(b);d||(d=1E3);if(d&&!Ja)h="Bsleep",L("B sleeping "+d),E=!0,ha=Z+d,Ja=!0;else{Ja=!0;c.desc=
"post_B/Breveal";c.validate_result=null;if(g_v2engine||Za)verbose_log("calling reveal JS after B state"),A(a,b,ob);kb=!0;CPWbot_bg.wait_for_doc_complete(a,null,function(a,b){L("B-reveal milestone");h="B1Rpre";U=b},c)}}function la(a,b,c){CPWbot_bg.do_milestone(a,Gc,b);h="L";CPWbot_bg.mark_timestamp("logout_cpw");var d=CPWbot_bg.navigate_to_logout(a,c);null===d?verbose_log("L: navigate_to_logout / CS callout "):d?y(a,b,c):(CPWbot_bg.do_milestone(a,Jb,b,""),z(a));return!0}function na(a,b,c){L("post_L");
E=!1;var d=oc(b);d||(d=1E3);if(d&&!Na)return h="Lsleep",L("L sleeping "+d),E=!0,ha=Z+d,Na=!0,null;Na=!0;bb&&A(a,b,Tb);return g_cpw_do_fakeui?(b&&(c&&null!==a)&&g_cpw_do_fakeui&&(h="FK0",verbose_log("entered do_logged_out_fake_ui")),d=0*Wa(b)+1017,setTimeout(function(){y(a,b,c)},d),null):y(a,b,c)}function qa(a,b,c){verbose_log("M2: validate_login_entry_success ");h="M2";var d=null,d=CPWbot_bg.validate_login_entry_success(a,b,P);if(null===d)return verbose_log("M2: validate_login_entry_success / CS callout "),
w=!0,L("VALIDATE_IN_DOCWAIT=true"),null;verbose_log("M2: validate_login_entry_success "+d+" no CS callout ");if(d)c.check_login_entry_form=!1,K(a,b,c);else return CPWbot_bg.do_milestone(a,Ea,b,V),z(a),retval}var k=c.aid,l=c.recipe,Z=(new Date).getTime();d=!1;if(0==jb){CPWbot_bg.mark_timestamp("initial_cycle");var r;u&&(r=u.initial_cycle-u.dopwchange,1E4<r&&(0!=u.initial_cycle&&0!=u.dopwchange)&&(T=2,Ac(l,T)));CPWbot_bg.do_milestone(a,72,l);null!==CPWbot_bg.broken_hearted_st_id&&clearTimeout(CPWbot_bg.broken_hearted_st_id);
CPWbot_bg.broken_hearted_st_id=null;wc(a,l)}jb++;e("engine awaken tick="+jb);if(null===h)z(a);else if(Aa||!lploggedin)Cc(a,l);else{if(!ta){(r=wb(l))||(r=DEFAULT_SESSION_TIMEOUT);var G=CPWbot_bg.get_timestamp("docaptcha_success");G||(G=CPWbot_bg.get_timestamp("initial_cycle"));G||(G=Ic);if(Z>G+r*T){d=!0;CPWbot_bg.do_milestone(a,140,l,"engine");CPWbot_bg.panic("TIMEOUT-engine");return}}r=Ua(l);if(t&&0<sb&&Z>sb+r){a:{for(r=0;r<ka.length;r++)if(G=ka[r],"validate_response"==G.type){r=!0;break a}r=!1}r?
pass:(w=!1,L("ENGINE - VALIDATE_IN_DOCWAIT=false"),CPWbot_bg.finish_cpwbot_validate_state(a,R,hc,ic,S))}if(b&&E)if(Z>ha)e("AWAKEN FROM SLEEP");else{e("CONTINUE SLEEPING");xa(a,h,c);return}b=null;for(b=0;b<ka.length;b++)switch(r=ka[b],G=r.data.docnum,e(sprintf("[%s][%d] processing event#%d cmd=%s",a,G,b,r.data.cmd)),r.type){case "validate_response":CPWbot_bg.cpwbot_validate_state_result_handler(r.tabid,r.data);break;case "fill_ack":CPWbot_bg&&CPWbot_bg.fill_ack_handler(r.tabid,r.data);break;case "click_ack":CPWbot_bg&&
CPWbot_bg.click_ack_handler(r.tabid,r.data);break;case "js_ack":CPWbot_bg&&CPWbot_bg.js_ack_handler(r.tabid,r.data);break;case "finish_ack":CPWbot_bg&&CPWbot_bg.cpwbot_finish_ack_handler(r.tabid,r.data);break;case "loadurl":if(g_CS_tops&&g_CS_tops[a]==G)switch(N&&(N=!1,e("m_in_loadurl cleared")),e("loadurl/setprefs against top :"+g_CS_tops[a]+" == "+G+" start_state="+CPWbot_bg.get_pwchangestate()),h){case "A1":case "A2":case "A3":case "M":case "B1":case "F":CPWbot_bg&&X&&(CPWbot_bg.force_validate_retry(!0),
CPWbot_bg.retry_validate(a));break;case 0:case "0":e("engine called in initial state - ignoring")}else if(null!==CPWbot_bg.get_pwchangetabid()&&CPWbot_bg.in_validate())L("processing loadurl event, reissue last validate to new doc ["+a+"]["+G+"]"),CPWbot_bg.retry_validate(a,G);else if(null!==CPWbot_bg.get_pwchangetabid()&&(ea||ba||da||oa||ja||pa||ra||ia))L("loadurl sent while waiting for a click, issue last click to new frame"+G),zc(a,G);break;case "unload":break;default:e("need to handle this msg: "+
r.data.cmd)}CPWbot_bg.clear_event_queue();e("current state is "+h);var P=ga;h&&null===P&&(P={aid:k});switch(h){case 0:h="A1";k=CPWbot_bg.check_is_logged_in(a,l,P);null===k?(verbose_log("A1: check_is_logged_in / CS callout "),w=!0,L("VALIDATE_IN_DOCWAIT=true")):(verbose_log("A1: check_is_logged_in returns "+k+" no CS callout "),(b=O)?la(a,l,c):y(a,l,c));break;case "A1":CPWbot_bg.in_validate()||w?(e("waiting for validate to end, "+h),pass):za?(e("waiting for doc-complete for Cnav, "+h),pass):t?e("A1: wait on m_in_validate"):
(k=b=O)?(CPWbot_bg.do_milestone(a,67,l),la(a,l,c)):null===k?CPWbot_bg.alert("A1 unexpected"):y(a,l,c);break;case "A3R":ra?(e("waiting for click_ack, "+h),fa(a),pass):N?(e("waiting for loadurl , "+h),pass):I(a,l,c);break;case "B1Rpre":ia=!1;(k=lb(l))?(h="B1R",verbose_log("B1R: login-form-reveal"),verbose_log("click on FN_REVEAL_LOGIN field!"),b=DEFAULT_CLICK_DELAY,"undefined"!=typeof l.login_reveal_delay&&(b=l.login_reveal_delay),ia=!0,verbose_log("now waiting for click_ack B1R"),r=H(l),ma(a,k,b,r),
CPWbot_bg.mark_timestamp("wait_for_click_ack_B1R")):yc(a,l,c);break;case "B1R":ia?(e("waiting for click_ack, "+h),fa(a),pass):N?(e("waiting for loadurl , "+h),pass):t?e("B1R: wait on m_in_validate"):yc(a,l,c);break;case "B1":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(t)e("B1: wait on m_in_validate");else{k=b=O;if(s&&s.found_interactive){console_error("B1: found interactive field");ya(a,l);return}if(k)Q(a,l,c);else{debug&&(g_innerHTML_debug&&s.innerhtml)&&verbose_log("VALIDATE FAILURE, final innerHTML is "+
s.innerhtml);var V="";CPWbot_bg.do_milestone(a,wa,l,V);z(a);return}}break;case "A2":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(t)e("A2: wait on m_in_validate");else if(za)e("A2: wait on navigate");else{if(s&&s.found_interactive){console_error("A2: found interactive field");ya(a,l);return}if(b=O)g(a,l,c);else{V="";CPWbot_bg.do_milestone(a,Da,l,V);z(a);return}}break;case "A3":if(CPWbot_bg.in_validate()||w||t)e("waiting for validate to end, "+h),pass;else{k=b=O;if(s&&
s.found_interactive){console_error("A3: found interactive field");ya(a,l);return}k?(e("A3: has login form, calling do_A4"),s&&s.found_interactive&&e("A3: found_interactive=true"),Q(a,l,c)):(debug&&(g_innerHTML_debug&&s.innerhtml)&&verbose_log("VALIDATE FAILURE, final innerHTML is "+s.innerhtml),Y(a,l,c))}break;case "M":if(CPWbot_bg.in_validate()||w||t)e("waiting for validate to end, "+h),pass;else{k=b=O;if(s&&s.found_interactive){console_error("M: found interactive field");ya(a,l);return}k?(CPWbot_bg.mark_timestamp("login_entry"),
verbose_log("M4: FILL LOGIN"),h="M4",k=null,(k=bc(a,l,P))?(verbose_log("M5: SUBMIT LOGIN ENTRY"),h="M5",k=1100,(b=vb(l))&&(k=b),k&&verbose_log("waiting "+k+" ms after login waiting for site to bootstrap"),b=dc(a,l,P),!1===b?(CPWbot_bg.do_milestone(a,Ea,l,""),z(a)):null===b?k&&(E=!0,ha=Z+k):qa(a,l,c)):(CPWbot_bg.do_milestone(a,wa,l,""),z(a))):(verbose_log("did not find initial stage login form"),s.innerhtml&&verbose_log("final innerHTML is "+s.innerhtml),c.check_login_entry_form=!1,K(a,l,c))}break;
case "M2":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(t)e("M2: wait on m_in_validate");else if(za)e("M2: wait on navigate");else{if(s&&s.found_interactive){console_error("M2: found interactive field");ya(a,l);return}if(b=O)c.check_login_entry_form=!1,K(a,l,c);else{V="";s&&(V=sprintf("found_bad_match=%s, num_ok_matches=%s, retval=%s, url_success_match=%s, url_failure_match=%s",s.found_bad_match,s.num_ok_matches,s.retval,s.url_success_match,s.url_failure_match));
CPWbot_bg.do_milestone(a,Ea,l,V);z(a);return}}break;case "A4":break;case "A5":W(a,l,c);break;case "M5":qa(a,l,c);break;case "A":console_warn("engine state=A todo");break;case "B":N?(e("waiting for loadurl to complete, "+h),pass):kb?(e("waiting for doc-complete after loadurl, "+h),pass):ca(a,l,c);break;case "Bsleep":kb?(e("waiting for doc-complete after loadurl, "+h),pass):ca(a,l,c);break;case "C":da?(e("waiting for click_ack, "+h),fa(a),pass):N?(e("waiting for loadurl , "+h),pass):ua?(e("waiting for reveal-cpw doc-complete, "+
h),pass):(k=g_CS_tops[a],"undefined"==typeof k&&(k=null),b=null,null!==k?(b=getcsinfo(a,k))?(r=b.docstate,"complete"==b.docstate&&"complete"==r?(e("C: wait completed "+h),j(a,l,c)):e("C: wait docstate:"+b.docstate+",last:"+r)):e("C: fail"):e("C: wtf - wait for page to finish loading?"),null!==k?ping(a,k):ping(a));break;case "Cnav":L("aid = "+U.payload.aid);CPWbot_bg.navigate_to_acctmgmt(a,U);U=null;break;case "Cpickup":da&&(L("still waiting for click-C"),e("waiting for click_ack, "+h),fa(a));ua?L("still waiting for document-complete to run reveal_cpw"):
j(a,l,c);break;case "A3Rsleep":I(a,l,c);break;case "B1Rsleep":K(a,l,c);break;case "Csleep":ua?L("still waiting for document-complete to run reveal_cpw"):j(a,l,c);break;case "Dpickup":iscpwfast()&&CPWbatch.conditional_website_status_update({aid:k,state:76,msg:"SLOW"});ba?(L("still waiting for click-D"),e("waiting for click_ack, "+h),fa(a)):p(a,l,c);break;case "Dsleep":p(a,l,c);break;case "Epickup":iscpwfast()&&CPWbatch.conditional_website_status_update({aid:k,state:76,msg:"SLOW"});ea?(L("still waiting for click-E"),
e("waiting for click_ack, "+h),fa(a)):(c.validate_result=null,C(a,l,c));break;case "Esleep":c.validate_result=null;C(a,l,c);break;case "D":e("engine handle D");ba||N?(ba?(e("waiting for click_ack, "+h),fa(a)):e("waiting for load to complete, "+h),pass):(k=g_CS_tops[a],"undefined"==typeof k&&(k=null),b=null,null!==k?(b=getcsinfo(a,k))?(r=b.docstate,"complete"==b.docstate&&"complete"==r?(e("D: wait completed "+h),p(a,l,c)):e("D: wait docstate:"+b.docstate+",last:"+r)):e("D: fail"):e("D: wtf - wait for page to finish loading?"),
null!==k?ping(a,k):ping(a));break;case "Dreveal":CPWbot_bg.reveal_cpw(a,U);U=null;break;case "D1":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(t)e("D1: wait on m_in_validate");else if(Ga)e("D1: wait on doc-complete for trigger_cpw");else{k=b=O;if(s&&s.found_interactive){console_error("D1: found interactive field");ya(a,l);return}k?B(a,l,c):v(a,l,c)}break;case "D2":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(t)e("D2: wait on m_in_validate");
else if(b=O)x(a,l,c);else{V="";CPWbot_bg.do_milestone(a,ib,l,V);z(a);return}break;case "D4":break;case "D5":oa?(e("waiting for click_ack, "+h),fa(a)):Ga?e("D5: wait on doc-complete for trigger_cpw"):B(a,l,c);break;case "D3":console_error("D3 reached - should not happen");break;case "D_validate_cpw_form":$(a,U);U=null;break;case "E":console_error("E: should not occur");break;case "Etrigger":ea?(e("waiting for click_ack, "+h),fa(a)):N?console_error("Etrigger: m_in_loadurl should not happen"):t?console_error("Etrigger: m_in_validate should not happen"):
(CPWbot_bg.trigger_cpw(a,U),U=null);break;case "F":if(CPWbot_bg.in_validate()||w)e("waiting for validate to end, "+h),pass;else if(N)e("waiting for loadurl and doc-complete"),pass;else if(t)e("F: wait on m_in_validate"),pass;else{CPWbot_bg.bagration();var aa=b=O;if(null!==aa)if(verbose_log("F: VALIDATE return from CS, returned "+aa),debug&&(g_innerHTML_debug&&O.innerhtml&&!aa)&&verbose_log("VALIDATE FAILURE, final innerHTML is "+O.innerhtml),V="",aa){verbose_log("cpwbot initiate: validate cpw succeeded, now updating user record");
f=P;if(!l||!f)d=!1;else if(n(F,"Updating with New Password"),b=!0,r=f.aid,console_log("cpwbot initiate: save_replace for aid="+r),G=va(r)){d=lpdec_acct(f.newpw,G,"undefined"==typeof g_shares?lpshares:g_shares);f=lpdec_acct(f.curpw,G,"undefined"==typeof g_shares?lpshares:g_shares);if(G&&d&&f)if(G.pwprotect&&(b=!1),console_log("cpwbot initiate: calling changepw logic for aid="+r),g_isfirefox)(b||LP.securityPrompt())&&lpchangepw(null,d,r,null,null,null,!0);else{var sa={singleaid:r.toString(),newpw:d,
autochange:1};b?changepw_wrapper(sa):security_prompt(function(){changepw_wrapper(sa)})}else verbose_log("no passwords to save? acct.aid = "+(G?G.aid:"null")+" cur="+(g_show_pw_in_logs||g_isadmin?f:"REDACTED")+" newpw="+(g_show_pw_in_logs||g_isadmin?d:"REDACTED"));d=!0}else Ba("given invalid aid - data consistency error?"),d=!1;d?(CPWbot_bg.do_milestone(a,63,l),d=va(k),d=lpdec_acct(Ab,d,"undefined"==typeof g_shares?lpshares:g_shares),k=lp_gettld_url(!l?null:l.login_url),verbose_log('remember to g_didchangepw for pw="'+
(g_show_pw_in_logs||g_isadmin?d:"REDACTED")+'" tld='+k),remember_changed_pw(d,k)||verbose_log('save to g_didchangepw failed for pw="'+(g_show_pw_in_logs||g_isadmin?d:"REDACTED")+'" tld='+k),Rb(l)&&(d=1234,k=0,l?"undefined"!=typeof l.js_finish_delay&&(k=l.js_finish_delay):k=null,k&&(d=k),setTimeout(function(){CPWbot_bg.conditional_js_exec(a,l,Rb)},d)),console_error("The End.")):CPWbot_bg.do_milestone(a,136,l,V)}else CPWbot_bg.do_milestone(a,135,l,V);z(a);d=!0}break;case "G":break;case "L":ja?(e("waiting for click_ack, "+
h),fa(a),pass):N?(e("waiting for loadurl , "+h),pass):(k=g_CS_tops[a],"undefined"==typeof k&&(k=null),b=null,null!==k&&((b=getcsinfo(a,k))?"complete"==b.docstate&&(e("L: wait completed "+h),na(a,l,c)):e("L: fail")),null!==k?ping(a,k):ping(a));break;case "Lsleep":na(a,l,c);break;case "Bagration":break;case "FK0":break;case "FK1":break;case "FK2":break;case "FKI":break;case "FK3":y(a,l,c);break;case "FKLL0":break;case "FKLL1":break;case "FKLL2":break;case "FKLLI":break;case "FKLL3":g(a,l,c);break;default:pass}d||
xa(a,h,c)}};this.initialize_engine=function(a,b){Ic=(new Date).getTime();var c=b.recipe;ga=b;CPWbot_bg.mark_timestamp("initialize_engine");Ha=t=E=Na=Ma=La=Ka=Ja=Ia=m_in_logout_reveal=kb=ua=za=Ga=N=!1;CPWbot_bg.do_milestone(a,65,c);var d;d=0;c?"undefined"!=typeof c.start_delay&&(d=c.start_delay):d=null;if(d)Bb||(Bb=!0,setTimeout(function(){xa(a,0,b);return!1},d));else if(Sb(c)&&!Cb){d=5E3;var e;e=0;c?"undefined"!=typeof c.post_js_begin_delay&&(e=c.post_js_begin_delay):e=null;e&&(d=e);Cb=!0;verbose_log("initial JS inject before beginning - inject, and wait ");
CPWbot_bg.conditional_js_exec(a,c,Sb);setTimeout(function(){xa(a,0,b);return!1},d)}else xa(a,0,b)};this.push_event_queue=function(a,b,c){if("validate_response"==a&&"undefined"!=typeof c.desc&&"docaptcha"==c.desc)ta&&0<JSON.parse(c.result_obj).num_ok_matches&&(CPWbot_bg.mark_timestamp("docaptcha_success"),A(b,B,Tc),ta=!1,CPWbot_bg.show_cpwbot_overlay(b,null,null),wc(b,B),X=null,t=!1,s.found_interactive=!1,O=!0,xa(b,h,ga));else{var d={};d.type=a;d.data=c;d.tabid=b;d.docnum=c.docnum;d.addtime=new Date;
null===ka&&(ka=[]);"undefined"!=typeof d.docnum&&verbose_log(sprintf("[%s][%d] pushed event : %s cmd=%s",b,d.docnum,a,c.cmd));ka.push(d)}};this.clear_event_queue=function(){ka=[]};this.select_execute=function(){};this.select=function(){};this.bagration=function(){h="Bagration"};this.in_bagration=function(){return"Bagration"==h};this.get_selenium_tabid=function(){return Hc};this.navigate_to_logout=function(a,b){if(!b)return!1;h="L";bb=!1;var c=b.recipe;if(!c)return!1;var d=!1,e=!1,e=A(a,c,Oc);n(F,
"Navigate to Logout");var g=I(c);if(g)return L("call logout:loadurl with "+g),e=null,g_CS_tops&&(e=g_CS_tops[a]),sendCS(a,{cmd:"loadurl",url:g},e),N=!0,verbose_log("m_in_loadurl set"),B=c,ga=b,bb=!0,null;ja=!1;if(g=J(c,FN_NAVIGATE_TO_LOGOUT)){verbose_log("click on FN_NAVIGATE_TO_LOGOUT field!");d=DEFAULT_CLICK_DELAY;"undefined"!=typeof c.logout_delay&&(d=c.logout_delay);ja=!0;verbose_log("now waiting for click_ack L");var j=H(c);ma(a,g,d,j);CPWbot_bg.mark_timestamp("wait_for_click_ack_L");d=null}g=
!1;c?"undefined"!=typeof c.logout_js_delay&&(g=c.logout_js_delay?!0:!1,"0"===c.logout_js_delay&&(g=!1)):g=null;if(g&&(bb=!0,oc(c)))return null;e=e||A(a,c,Tb);!1===d&&e&&(d=!0);return d};var T=1,u=null;this.get_timestamp=function(a){if(!a)return null;null===u&&(u=new Bc);return u[a]};this.get_timestamps=function(){return u};this.mark_timestamp=function(a){if(null===u||"dopwchange"==a)u=new Bc;var b=(new Date).getTime();u[a]=b;return!0};this.dump_timestamps=function(){var a;if(u)for(a in u)L(sprintf("[%s] timestamp %s : %d",
Y(B),a,u[a]));Ac(B,T);return!0};this.get_last_timestamp=function(a){var b,c="dopwchange";if(u){for(b in u)if(!a||!("fail"===b||"finish_complete"==b||"success"==b))u[b]>u[c]&&(c=b);return c}return null};this.broken_hearted=function(a){if(CPWbot_bg)if(a!=CPWbot_bg.get_session())n(K,"stale setTimeout - clearTimeout did not work");else if(a=CPWbot_bg.get_timestamp("initial_cycle"),(new Date).getTime(),"undefined"==typeof a&&(a=null),!a&&("preinit"==h||!h)&&!CPWbot_bg.get_okstate()&&!CPWbot_bg.get_failstate()&&
!CPWbot_bg.in_bagration())CPWbot_bg.do_milestone(x,133,B,"brokenhearted"),CPWbot_bg.panic("TIMEOUT-brokenhearted")};this.new_session=function(a){a||(a="");var b=(new Date).getTime();null===b&&(b=0);return Kb=("function"==typeof lp_sha256?lp_sha256:SHA256)(a.toString()+b.toString())};this.get_session=function(){return Kb};this.clear_session=function(){Kb=""};this.halt=function(a){if(a&&"undefined"!==typeof a.aid&&CPWbot_bg.getpwchangeaid()!==a.aid)return!1;null!==CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id);
CPWbot_bg.docaptcha_si_id=null;Aa=!0;L("Halt Requested")};this.cpw_dialog_minimize_state=0;this.getpwchangeaid=function(){return qa};this.phone_home=function(a,b,c){if(!c)return!1;b||(b=B);var d=(new Date).getTime();a=(d-CPWbot_bg.get_timestamp("dopwchange"))/1E3;if(0>a||isNaN(a))a=0;d=(d-CPWbot_bg.get_timestamp("initial_cycle"))/1E3;if(0>d||isNaN(d))d=0;var e=CPWbot_bg.get_last_timestamp(!0),g=c.msg?c.msg:"";b=sprintf("[%s][%s][R=%s][L=%s][M=%s][%6.2fsec elapsed][%2.1f TF][%6.2fsec TiE]","cpw",c.severity?
c.severity:"",b?Y(b):"bad-recipe",e,g,a,T,d);L(b);lpReportError(b,null);return!0};this.warning_phone_home=function(a){return Ba(a)};this.site_html_url="";"undefined"!=typeof g_iscasper&&g_iscasper&&(this.get_validate_timeout=function(a){return Ua.apply(this,arguments)},this.get_symbolic=function(a){return Y.apply(this,arguments)},this.get_logout_url=function(a){return I.apply(this,arguments)},this.get_generate_prefs_from_recipe=function(a){return lc.apply(this,arguments)},this.set_last_overlay_message=
function(a){return g.apply(this,arguments)},this.clear_last_overlay_message=function(a){return e.apply(this,arguments)},this.validate_xpath=function(a){return qc.apply(this,arguments)},this.validate_recipe=function(a){return rc(a)},this.get_cpw_login_password_field=function(a){return q.apply(this,arguments)},this.get_cpw_login_username_field=function(a){return Oa.apply(this,arguments)},this.get_login_submit_field=function(a){return Pa.apply(this,arguments)},this.get_login_reveal_field=function(a){return lb.apply(this,
arguments)},this.replace_constants=function(a){return replace_constants.apply(this,arguments)},this.set_pwchangestate=function(a){h=a;return!0},this.in_wait_for_click=function(){return ea||ba||da||oa||ja||pa||ra||ia},this.submit_login_form=function(a,b,c){return rb(a,b,c)},this.fill_login_form=function(a,b,c){return Ra(a,b,c)},this.clear_wait_for_clicks=function(){return tc()},this.get_event_queue=function(){return ka},this.reset_private_test_vars=function(){w=t=gb=!1},this.should_click_on_fill=function(a){return Sa(a)},
this.should_fill_password_fields_via_keys=function(a){return Ta(a)},this.get_fill_delay=function(a){return Wa(a)},this.random_delay=function(a){return W(a)},this.random_sleep=function(a,b){var c;(c=a)||(c=100);typeof("undefined"==b)||null==b||"undefined"==typeof Math?c=!1:(c=random(c)+10,setTimeout(function(){b()},c),c=!0);return c},this.get_cpw_session_timeout=function(a){return wb(a)},this.fill_login_entry_form=function(a,b,c){return bc(a,b,c)},this.submit_login_entry_form=function(a,b,c){return dc(a,
b,c)},this.set_pwchange_validate_desc=function(a){S=a;return!0},this.check_recipe_symbols=function(a){return sc(a)},this.set_in_validate_outer=function(){return w=t=!0},this.set_in_validate_inner=function(a,b){X={cmd:"cpwbot_validate_state",desc:b,id:a};R=a;Dc.set_pwchange_validate_desc(b);null===C&&(C=[])},this.get_in_sleep=function(){return E},this.clear_sleeps=function(){E=Na=Ma=La=Ka=Ja=Ia=!1});return!0}
function get_recipe_for_url(g,e){lp_gettld_url(g);var I,H;g_isfirefox?(I=LP.lpMakeRequest,H=LP.lp_base):(I=lpMakeRequest,H=base_url);I(H+"get_recipe.php","url="+encodeURIComponent(g),function(g){if(4==g.readyState){if(200==g.status&&(null!=g.responseXML&&null!=g.responseXML.documentElement)&&(g=g.responseXML.documentElement.getElementsByTagName("result"),0<g.length))if(g=g[0].getAttribute("recipe"),""==g)(!CPWbatch||!CPWbatch.cpw_get_batchjob_state())&&CPWbot_bg.alert("This url is not supported yet"),
CPWbot_bg.do_milestone(null,128,null,"no recipe");else{e(replace_constants(JSON.parse(g)));return}e(null)}},function(){e(null)})}function ping_ack_handler(g,e){var I=e.docnum,H=e.url,q=e.id,Oa=e.delta,Pa=(new Date).getTime()-e.timestamp;debug&&L("received ping response from [tabid:"+g+"][docnum:"+I+"][id:"+q+" sent: "+Oa+"ms, response: "+Pa+"ms docstate="+e.docstate+" url="+H);q=getcsinfo(g,I);q||(q=new CS_t,q.docnum=I,q.tabid=g);q.url=H;q.docstate=e.docstate;q.flags=e.flags;setcsinfo(g,I,q)}
function ping(g,e){var I=(new Date).getTime(),H=!1;if("undefined"==typeof g||null===g)H=!0;if("undefined"==typeof e||null===e)e="all";var q=("function"==typeof lp_sha256?lp_sha256:SHA256)(g_username+""+g+""+e+""+I);debug&&L("sending ping id="+q);if(H)for(g in g_CS)"undefined"!=typeof g&&null!==g&&sendCS(g,{cmd:"ping_req",id:q,timestamp:I},e);else sendCS(g,{cmd:"ping_req",id:q,timestamp:I},e)}
function cpwbot_getpwchangestate(){return g_cpwbot&&CPWbot_bg?"Bagration"==CPWbot_bg.get_pwchangestate()?!0===CPWbot_bg.get_failstate()?!0===CPWbot_bg.get_failpwsavedstate()?"FAIL_PW_SAVED":"FAIL":!0===CPWbot_bg.get_okstate()?"OK":null:!0===CPWbot_bg.get_captchastate()?"CAPTCHA":!0===CPWbot_bg.get_docaptchastate()?"DOCAPTCHA":!0===CPWbot_bg.get_brokenheartstate()?"TIMEOUT":"preinit"==CPWbot_bg.get_pwchangestate()?null:!0===CPWbot_bg.get_failstate()?!0===CPWbot_bg.get_failpwsavedstate()?"FAIL_PW_SAVED":
"FAIL":!0===CPWbot_bg.get_okstate()?"OK":CPWbot_bg.get_pwchangestate():"FAIL"}function cpwbot_preinit(){CPWbot_bg&&CPWbot_bg.preinit()}function cpwbot_get_user_debug_messages(){if(CPWbot_bg)return CPWbot_bg.get_user_debug_messages()}function cpwbot_get_dialog_msg(){if(CPWbot_bg)return CPWbot_bg.get_dialog_msg()}function cpwbot_halt(){if(CPWbot_bg)return CPWbot_bg.halt()}function cpwbot_minimize_dialog(){CPWbot_bg&&(CPWbot_bg.cpw_dialog_minimize_state=1)}
function cpwbot_maximize_dialog(){CPWbot_bg&&(CPWbot_bg.cpw_dialog_minimize_state=0)}function cpwbot_get_minimize_dialog_state(){if(CPWbot_bg)return CPWbot_bg.cpw_dialog_minimize_state};
